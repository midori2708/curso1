function onApiLoad(){gapi.load("auth",{callback:onAuthApiLoad}),gapi.load("picker",{callback:onPickerApiLoad})}function onAuthApiLoad(){window.gapi.auth.authorize({client_id:gdrive_clientId,scope:scope,immediate:!1},handleAuthResult)}function onPickerApiLoad(){pickerApiLoaded=!0}function handleAuthResult(e){e&&!e.error&&(oauthToken=e.access_token,oauthData=e,createPicker())}function createPicker(){if(pickerApiLoaded&&oauthToken){var e=new google.picker.DocsView(google.picker.ViewId.DOCS);e.setMode(google.picker.DocsViewMode.LIST),e.setIncludeFolders(!0),e.setOwnedByMe(!0);(new google.picker.PickerBuilder).addView(e).setOAuthToken(oauthToken).setDeveloperKey(gdrive_developerKey).setCallback(pickerCallback).build().setVisible(!0)}}function pickerCallback(e){if(e[google.picker.Response.ACTION]==google.picker.Action.PICKED){var t=e[google.picker.Response.DOCUMENTS][0],o={fileId:t[google.picker.Document.ID],fileName:t[google.picker.Document.NAME],token:oauthToken,mimeType:t[google.picker.Document.MIME_TYPE]};!0===qgGdrive.drive.checkUsesGdrive()&&qgGdrive.drive.setFile(o.fileName,o.fileId,o.mimeType,o.token);document.querySelector("#drive_picker > .btn-status").style.background="transparent url('"+static_server+"/images/status-ok.png') no-repeat";var r=document.getElementById("gdrive_input");if(r)return void r.setAttribute("value",JSON.stringify(o));var i=document.createElement("input");i.setAttribute("type","hidden"),i.setAttribute("id","gdrive_input"),i.setAttribute("name","gdrive_input"),i.setAttribute("value",JSON.stringify(o)),document.getElementById("forms").appendChild(i)}}!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery","jquery-ui/ui/widget"],e):"object"==typeof exports?e(require("jquery"),require("./vendor/jquery.ui.widget")):e(window.jQuery)}(function(e){"use strict";function t(t){var o="dragover"===t;return function(r){r.dataTransfer=r.originalEvent&&r.originalEvent.dataTransfer;var i=r.dataTransfer;i&&-1!==e.inArray("Files",i.types)&&!1!==this._trigger(t,e.Event(t,{delegatedEvent:r}))&&(r.preventDefault(),o&&(i.dropEffect="copy"))}}e.support.fileInput=!(new RegExp("(Android (1\\.[0156]|2\\.[01]))|(Windows Phone (OS 7|8\\.0))|(XBLWP)|(ZuneWP)|(WPDesktop)|(w(eb)?OSBrowser)|(webOS)|(Kindle/(1\\.0|2\\.[05]|3\\.0))").test(window.navigator.userAgent)||e('<input type="file"/>').prop("disabled")),e.support.xhrFileUpload=!(!window.ProgressEvent||!window.FileReader),e.support.xhrFormDataFileUpload=!!window.FormData,e.support.blobSlice=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice),e.widget("blueimp.fileupload",{options:{dropZone:e(document),pasteZone:undefined,fileInput:undefined,replaceFileInput:!0,paramName:undefined,singleFileUploads:!0,limitMultiFileUploads:undefined,limitMultiFileUploadSize:undefined,limitMultiFileUploadSizeOverhead:512,sequentialUploads:!1,limitConcurrentUploads:undefined,forceIframeTransport:!1,redirect:undefined,redirectParamName:undefined,postMessage:undefined,multipart:!0,maxChunkSize:undefined,uploadedBytes:undefined,recalculateProgress:!0,progressInterval:100,bitrateInterval:500,autoUpload:!0,messages:{uploadedBytes:"Uploaded bytes exceed file size"},i18n:function(t,o){return t=this.messages[t]||t.toString(),o&&e.each(o,function(e,o){t=t.replace("{"+e+"}",o)}),t},formData:function(e){return e.serializeArray()},add:function(t,o){if(t.isDefaultPrevented())return!1;(o.autoUpload||!1!==o.autoUpload&&e(this).fileupload("option","autoUpload"))&&o.process().done(function(){o.submit()})},processData:!1,contentType:!1,cache:!1,timeout:0},_specialOptions:["fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_blobSlice:e.support.blobSlice&&function(){return(this.slice||this.webkitSlice||this.mozSlice).apply(this,arguments)},_BitrateTimer:function(){this.timestamp=Date.now?Date.now():(new Date).getTime(),this.loaded=0,this.bitrate=0,this.getBitrate=function(e,t,o){var r=e-this.timestamp;return(!this.bitrate||!o||r>o)&&(this.bitrate=(t-this.loaded)*(1e3/r)*8,this.loaded=t,this.timestamp=e),this.bitrate}},_isXHRUpload:function(t){return!t.forceIframeTransport&&(!t.multipart&&e.support.xhrFileUpload||e.support.xhrFormDataFileUpload)},_getFormData:function(t){var o;return"function"===e.type(t.formData)?t.formData(t.form):e.isArray(t.formData)?t.formData:"object"===e.type(t.formData)?(o=[],e.each(t.formData,function(e,t){o.push({name:e,value:t})}),o):[]},_getTotal:function(t){var o=0;return e.each(t,function(e,t){o+=t.size||1}),o},_initProgressObject:function(t){var o={loaded:0,total:0,bitrate:0};t._progress?e.extend(t._progress,o):t._progress=o},_initResponseObject:function(e){var t;if(e._response)for(t in e._response)e._response.hasOwnProperty(t)&&delete e._response[t];else e._response={}},_onProgress:function(t,o){if(t.lengthComputable){var r,i=Date.now?Date.now():(new Date).getTime();if(o._time&&o.progressInterval&&i-o._time<o.progressInterval&&t.loaded!==t.total)return;o._time=i,r=Math.floor(t.loaded/t.total*(o.chunkSize||o._progress.total))+(o.uploadedBytes||0),this._progress.loaded+=r-o._progress.loaded,this._progress.bitrate=this._bitrateTimer.getBitrate(i,this._progress.loaded,o.bitrateInterval),o._progress.loaded=o.loaded=r,o._progress.bitrate=o.bitrate=o._bitrateTimer.getBitrate(i,r,o.bitrateInterval),this._trigger("progress",e.Event("progress",{delegatedEvent:t}),o),this._trigger("progressall",e.Event("progressall",{delegatedEvent:t}),this._progress)}},_initProgressListener:function(t){var o=this,r=t.xhr?t.xhr():e.ajaxSettings.xhr();r.upload&&(e(r.upload).bind("progress",function(e){var r=e.originalEvent;e.lengthComputable=r.lengthComputable,e.loaded=r.loaded,e.total=r.total,o._onProgress(e,t)}),t.xhr=function(){return r})},_deinitProgressListener:function(t){var o=t.xhr?t.xhr():e.ajaxSettings.xhr();o.upload&&e(o.upload).unbind("progress")},_isInstanceOf:function(e,t){return Object.prototype.toString.call(t)==="[object "+e+"]"},_initXHRData:function(t){var o,r=this,i=t.files[0],n=t.multipart||!e.support.xhrFileUpload,a="array"===e.type(t.paramName)?t.paramName[0]:t.paramName;t.headers=e.extend({},t.headers),t.contentRange&&(t.headers["Content-Range"]=t.contentRange),n&&!t.blob&&this._isInstanceOf("File",i)||(t.headers["Content-Disposition"]='attachment; filename="'+encodeURI(i.uploadName||i.name)+'"'),n?e.support.xhrFormDataFileUpload&&(t.postMessage?(o=this._getFormData(t),t.blob?o.push({name:a,value:t.blob}):e.each(t.files,function(r,i){o.push({name:"array"===e.type(t.paramName)&&t.paramName[r]||a,value:i})})):(r._isInstanceOf("FormData",t.formData)?o=t.formData:(o=new FormData,e.each(this._getFormData(t),function(e,t){o.append(t.name,t.value)})),t.blob?o.append(a,t.blob,i.uploadName||i.name):e.each(t.files,function(i,n){(r._isInstanceOf("File",n)||r._isInstanceOf("Blob",n))&&o.append("array"===e.type(t.paramName)&&t.paramName[i]||a,n,n.uploadName||n.name)})),t.data=o):(t.contentType=i.type||"application/octet-stream",t.data=t.blob||i),t.blob=null},_initIframeSettings:function(t){var o=e("<a></a>").prop("href",t.url).prop("host");t.dataType="iframe "+(t.dataType||""),t.formData=this._getFormData(t),t.redirect&&o&&o!==location.host&&t.formData.push({name:t.redirectParamName||"redirect",value:t.redirect})},_initDataSettings:function(e){this._isXHRUpload(e)?(this._chunkedUpload(e,!0)||(e.data||this._initXHRData(e),this._initProgressListener(e)),e.postMessage&&(e.dataType="postmessage "+(e.dataType||""))):this._initIframeSettings(e)},_getParamName:function(t){var o=e(t.fileInput),r=t.paramName;return r?e.isArray(r)||(r=[r]):(r=[],o.each(function(){for(var t=e(this),o=t.prop("name")||"files[]",i=(t.prop("files")||[1]).length;i;)r.push(o),i-=1}),r.length||(r=[o.prop("name")||"files[]"])),r},_initFormSettings:function(t){t.form&&t.form.length||(t.form=e(t.fileInput.prop("form")),t.form.length||(t.form=e(this.options.fileInput.prop("form")))),t.paramName=this._getParamName(t),t.url||(t.url=t.form.prop("action")||location.href),t.type=(t.type||"string"===e.type(t.form.prop("method"))&&t.form.prop("method")||"").toUpperCase(),"POST"!==t.type&&"PUT"!==t.type&&"PATCH"!==t.type&&(t.type="POST"),t.formAcceptCharset||(t.formAcceptCharset=t.form.attr("accept-charset"))},_getAJAXSettings:function(t){var o=e.extend({},this.options,t);return this._initFormSettings(o),this._initDataSettings(o),o},_getDeferredState:function(e){return e.state?e.state():e.isResolved()?"resolved":e.isRejected()?"rejected":"pending"},_enhancePromise:function(e){return e.success=e.done,e.error=e.fail,e.complete=e.always,e},_getXHRPromise:function(t,o,r){var i=e.Deferred(),n=i.promise();return o=o||this.options.context||n,!0===t?i.resolveWith(o,r):!1===t&&i.rejectWith(o,r),n.abort=i.promise,this._enhancePromise(n)},_addConvenienceMethods:function(t,o){var r=this,i=function(t){return e.Deferred().resolveWith(r,t).promise()};o.process=function(t,n){return(t||n)&&(o._processQueue=this._processQueue=(this._processQueue||i([this])).then(function(){return o.errorThrown?e.Deferred().rejectWith(r,[o]).promise():i(arguments)}).then(t,n)),this._processQueue||i([this])},o.submit=function(){return"pending"!==this.state()&&(o.jqXHR=this.jqXHR=!1!==r._trigger("submit",e.Event("submit",{delegatedEvent:t}),this)&&r._onSend(t,this)),this.jqXHR||r._getXHRPromise()},o.abort=function(){return this.jqXHR?this.jqXHR.abort():(this.errorThrown="abort",r._trigger("fail",null,this),r._getXHRPromise(!1))},o.state=function(){return this.jqXHR?r._getDeferredState(this.jqXHR):this._processQueue?r._getDeferredState(this._processQueue):void 0},o.processing=function(){return!this.jqXHR&&this._processQueue&&"pending"===r._getDeferredState(this._processQueue)},o.progress=function(){return this._progress},o.response=function(){return this._response}},_getUploadedBytes:function(e){var t=e.getResponseHeader("Range"),o=t&&t.split("-"),r=o&&o.length>1&&parseInt(o[1],10);return r&&r+1},_chunkedUpload:function(t,o){t.uploadedBytes=t.uploadedBytes||0;var r,i,n=this,a=t.files[0],s=a.size,l=t.uploadedBytes,d=t.maxChunkSize||s,u=this._blobSlice,p=e.Deferred(),c=p.promise();return!(!(this._isXHRUpload(t)&&u&&(l||("function"===e.type(d)?d(t):d)<s))||t.data)&&(!!o||(l>=s?(a.error=t.i18n("uploadedBytes"),this._getXHRPromise(!1,t.context,[null,"error",a.error])):(i=function(){var o=e.extend({},t),c=o._progress.loaded;o.blob=u.call(a,l,l+("function"===e.type(d)?d(o):d),a.type),o.chunkSize=o.blob.size,o.contentRange="bytes "+l+"-"+(l+o.chunkSize-1)+"/"+s,n._trigger("chunkbeforesend",null,o),n._initXHRData(o),n._initProgressListener(o),r=(!1!==n._trigger("chunksend",null,o)&&e.ajax(o)||n._getXHRPromise(!1,o.context)).done(function(r,a,d){l=n._getUploadedBytes(d)||l+o.chunkSize,c+o.chunkSize-o._progress.loaded&&n._onProgress(e.Event("progress",{lengthComputable:!0,loaded:l-o.uploadedBytes,total:l-o.uploadedBytes}),o),t.uploadedBytes=o.uploadedBytes=l,o.result=r,o.textStatus=a,o.jqXHR=d,n._trigger("chunkdone",null,o),n._trigger("chunkalways",null,o),l<s?i():p.resolveWith(o.context,[r,a,d])}).fail(function(e,t,r){o.jqXHR=e,o.textStatus=t,o.errorThrown=r,n._trigger("chunkfail",null,o),n._trigger("chunkalways",null,o),p.rejectWith(o.context,[e,t,r])}).always(function(){n._deinitProgressListener(o)})},this._enhancePromise(c),c.abort=function(){return r.abort()},i(),c)))},_beforeSend:function(e,t){0===this._active&&(this._trigger("start"),this._bitrateTimer=new this._BitrateTimer,this._progress.loaded=this._progress.total=0,this._progress.bitrate=0),this._initResponseObject(t),this._initProgressObject(t),t._progress.loaded=t.loaded=t.uploadedBytes||0,t._progress.total=t.total=this._getTotal(t.files)||1,t._progress.bitrate=t.bitrate=0,this._active+=1,this._progress.loaded+=t.loaded,this._progress.total+=t.total},_onDone:function(t,o,r,i){var n=i._progress.total,a=i._response;i._progress.loaded<n&&this._onProgress(e.Event("progress",{lengthComputable:!0,loaded:n,total:n}),i),a.result=i.result=t,a.textStatus=i.textStatus=o,a.jqXHR=i.jqXHR=r,this._trigger("done",null,i)},_onFail:function(e,t,o,r){var i=r._response;r.recalculateProgress&&(this._progress.loaded-=r._progress.loaded,this._progress.total-=r._progress.total),i.jqXHR=r.jqXHR=e,i.textStatus=r.textStatus=t,i.errorThrown=r.errorThrown=o,this._trigger("fail",null,r)},_onAlways:function(e,t,o,r){this._trigger("always",null,r)},_onSend:function(t,o){o.submit||this._addConvenienceMethods(t,o);var r,i,n,a,s=this,l=s._getAJAXSettings(o),d=function(){return s._sending+=1,l._bitrateTimer=new s._BitrateTimer,r=r||((i||!1===s._trigger("send",e.Event("send",{delegatedEvent:t}),l))&&s._getXHRPromise(!1,l.context,i)||s._chunkedUpload(l)||e.ajax(l)).done(function(e,t,o){s._onDone(e,t,o,l)}).fail(function(e,t,o){s._onFail(e,t,o,l)}).always(function(e,t,o){if(s._deinitProgressListener(l),s._onAlways(e,t,o,l),s._sending-=1,s._active-=1,l.limitConcurrentUploads&&l.limitConcurrentUploads>s._sending)for(var r=s._slots.shift();r;){if("pending"===s._getDeferredState(r)){r.resolve();break}r=s._slots.shift()}0===s._active&&s._trigger("stop")})};return this._beforeSend(t,l),this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending?(this.options.limitConcurrentUploads>1?(n=e.Deferred(),this._slots.push(n),a=n.then(d)):(this._sequence=this._sequence.then(d,d),a=this._sequence),a.abort=function(){return i=[undefined,"abort","abort"],r?r.abort():(n&&n.rejectWith(l.context,i),d())},this._enhancePromise(a)):d()},_onAdd:function(t,o){var r,i,n,a,s=this,l=!0,d=e.extend({},this.options,o),u=o.files,p=u.length,c=d.limitMultiFileUploads,f=d.limitMultiFileUploadSize,g=d.limitMultiFileUploadSizeOverhead,v=0,h=this._getParamName(d),m=0;if(!p)return!1;if(f&&u[0].size===undefined&&(f=undefined),(d.singleFileUploads||c||f)&&this._isXHRUpload(d))if(d.singleFileUploads||f||!c)if(!d.singleFileUploads&&f)for(n=[],r=[],a=0;a<p;a+=1)v+=u[a].size+g,(a+1===p||v+u[a+1].size+g>f||c&&a+1-m>=c)&&(n.push(u.slice(m,a+1)),i=h.slice(m,a+1),i.length||(i=h),r.push(i),m=a+1,v=0);else r=h;else for(n=[],r=[],a=0;a<p;a+=c)n.push(u.slice(a,a+c)),i=h.slice(a,a+c),i.length||(i=h),r.push(i);else n=[u],r=[h];return o.originalFiles=u,e.each(n||u,function(i,a){var d=e.extend({},o);return d.files=n?a:[a],d.paramName=r[i],s._initResponseObject(d),s._initProgressObject(d),s._addConvenienceMethods(t,d),l=s._trigger("add",e.Event("add",{delegatedEvent:t}),d)}),l},_replaceFileInput:function(t){var o=t.fileInput,r=o.clone(!0),i=o.is(document.activeElement);t.fileInputClone=r,e("<form></form>").append(r)[0].reset(),o.after(r).detach(),i&&r.focus(),e.cleanData(o.unbind("remove")),this.options.fileInput=this.options.fileInput.map(function(e,t){return t===o[0]?r[0]:t}),o[0]===this.element[0]&&(this.element=r)},_handleFileTreeEntry:function(t,o){var r,i=this,n=e.Deferred(),a=[],s=function(e){e&&!e.entry&&(e.entry=t),n.resolve([e])},l=function(e){i._handleFileTreeEntries(e,o+t.name+"/").done(function(e){n.resolve(e)}).fail(s)},d=function(){r.readEntries(function(e){e.length?(a=a.concat(e),d()):l(a)},s)};return o=o||"",t.isFile?t._file?(t._file.relativePath=o,n.resolve(t._file)):t.file(function(e){e.relativePath=o,n.resolve(e)},s):t.isDirectory?(r=t.createReader(),d()):n.resolve([]),n.promise()},_handleFileTreeEntries:function(t,o){var r=this;return e.when.apply(e,e.map(t,function(e){return r._handleFileTreeEntry(e,o)})).then(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(t){t=t||{};var o=t.items;return o&&o.length&&(o[0].webkitGetAsEntry||o[0].getAsEntry)?this._handleFileTreeEntries(e.map(o,function(e){var t;return e.webkitGetAsEntry?(t=e.webkitGetAsEntry(),t&&(t._file=e.getAsFile()),t):e.getAsEntry()})):e.Deferred().resolve(e.makeArray(t.files)).promise()},_getSingleFileInputFiles:function(t){t=e(t);var o,r,i=t.prop("webkitEntries")||t.prop("entries");if(i&&i.length)return this._handleFileTreeEntries(i);if(o=e.makeArray(t.prop("files")),o.length)o[0].name===undefined&&o[0].fileName&&e.each(o,function(e,t){t.name=t.fileName,t.size=t.fileSize});else{if(!(r=t.prop("value")))return e.Deferred().resolve([]).promise();o=[{name:r.replace(/^.*\\/,"")}]}return e.Deferred().resolve(o).promise()},_getFileInputFiles:function(t){return t instanceof e&&1!==t.length?e.when.apply(e,e.map(t,this._getSingleFileInputFiles)).then(function(){return Array.prototype.concat.apply([],arguments)}):this._getSingleFileInputFiles(t)},_onChange:function(t){var o=this,r={fileInput:e(t.target),form:e(t.target.form)};this._getFileInputFiles(r.fileInput).always(function(i){r.files=i,o.options.replaceFileInput&&o._replaceFileInput(r),!1!==o._trigger("change",e.Event("change",{delegatedEvent:t}),r)&&o._onAdd(t,r)})},_onPaste:function(t){var o=t.originalEvent&&t.originalEvent.clipboardData&&t.originalEvent.clipboardData.items,r={files:[]};o&&o.length&&(e.each(o,function(e,t){var o=t.getAsFile&&t.getAsFile();o&&r.files.push(o)}),!1!==this._trigger("paste",e.Event("paste",{delegatedEvent:t}),r)&&this._onAdd(t,r))},_onDrop:function(t){t.dataTransfer=t.originalEvent&&t.originalEvent.dataTransfer;var o=this,r=t.dataTransfer,i={};r&&r.files&&r.files.length&&(t.preventDefault(),this._getDroppedFiles(r).always(function(r){i.files=r,!1!==o._trigger("drop",e.Event("drop",{delegatedEvent:t}),i)&&o._onAdd(t,i)}))},_onDragOver:t("dragover"),_onDragEnter:t("dragenter"),_onDragLeave:t("dragleave"),_initEventHandlers:function(){this._isXHRUpload(this.options)&&(this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop,dragenter:this._onDragEnter,dragleave:this._onDragLeave}),this._on(this.options.pasteZone,{paste:this._onPaste})),e.support.fileInput&&this._on(this.options.fileInput,{change:this._onChange})},_destroyEventHandlers:function(){this._off(this.options.dropZone,"dragenter dragleave dragover drop"),this._off(this.options.pasteZone,"paste"),this._off(this.options.fileInput,"change")},_destroy:function(){this._destroyEventHandlers()},_setOption:function(t,o){var r=-1!==e.inArray(t,this._specialOptions);r&&this._destroyEventHandlers(),this._super(t,o),r&&(this._initSpecialOptions(),this._initEventHandlers())},_initSpecialOptions:function(){var t=this.options;t.fileInput===undefined?t.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]'):t.fileInput instanceof e||(t.fileInput=e(t.fileInput)),t.dropZone instanceof e||(t.dropZone=e(t.dropZone)),t.pasteZone instanceof e||(t.pasteZone=e(t.pasteZone))},_getRegExp:function(e){var t=e.split("/"),o=t.pop();return t.shift(),new RegExp(t.join("/"),o)},_isRegExpOption:function(t,o){return"url"!==t&&"string"===e.type(o)&&/^\/.*\/[igm]{0,3}$/.test(o)},_initDataAttributes:function(){var t=this,o=this.options,r=this.element.data();e.each(this.element[0].attributes,function(e,i){var n,a=i.name.toLowerCase();/^data-/.test(a)&&(a=a.slice(5).replace(/-[a-z]/g,function(e){return e.charAt(1).toUpperCase()}),n=r[a],t._isRegExpOption(a,n)&&(n=t._getRegExp(n)),o[a]=n)})},_create:function(){this._initDataAttributes(),this._initSpecialOptions(),this._slots=[],this._sequence=this._getXHRPromise(!0),this._sending=this._active=0,this._initProgressObject(this),this._initEventHandlers()},active:function(){return this._active},progress:function(){return this._progress},add:function(t){var o=this;t&&!this.options.disabled&&(t.fileInput&&!t.files?this._getFileInputFiles(t.fileInput).always(function(e){t.files=e,o._onAdd(null,t)}):(t.files=e.makeArray(t.files),this._onAdd(null,t)))},send:function(t){if(t&&!this.options.disabled){if(t.fileInput&&!t.files){var o,r,i=this,n=e.Deferred(),a=n.promise();return a.abort=function(){return r=!0,o?o.abort():(n.reject(null,"abort","abort"),a)},this._getFileInputFiles(t.fileInput).always(function(e){if(!r){if(!e.length)return void n.reject();t.files=e,o=i._onSend(null,t),o.then(function(e,t,o){n.resolve(e,t,o)},function(e,t,o){n.reject(e,t,o)})}}),this._enhancePromise(a)}if(t.files=e.makeArray(t.files),t.files.length)return this._onSend(null,t)}return this._getXHRPromise(!1,t&&t.context)}})}),function(e){"use strict";var t=function(e,o){var r=/[^\w\-.:]/.test(e)?new Function(t.arg+",tmpl","var _e=tmpl.encode"+t.helper+",_s='"+e.replace(t.regexp,t.func)+"';return _s;"):t.cache[e]=t.cache[e]||t(t.load(e));return o?r(o,t):function(e){return r(e,t)}};t.cache={},t.load=function(e){return document.getElementById(e).innerHTML},t.regexp=/([\s'\\])(?!(?:[^{]|\{(?!%))*%\})|(?:\{%(=|#)([\s\S]+?)%\})|(\{%)|(%\})/g,t.func=function(e,t,o,r,i,n){return t?{"\n":"\\n","\r":"\\r","\t":"\\t"," ":" "}[t]||"\\"+t:o?"="===o?"'+_e("+r+")+'":"'+("+r+"==null?'':"+r+")+'":i?"';":n?"_s+='":void 0},t.encReg=/[<>&"'\x00]/g,t.encMap={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#39;"},t.encode=function(e){return(null==e?"":""+e).replace(t.encReg,function(e){return t.encMap[e]||""})},t.arg="o",t.helper=",print=function(s,e){_s+=e?(s==null?'':s):_e(s);},include=function(s,d){_s+=tmpl(s,d);}","function"==typeof define&&define.amd?define(function(){return t}):"object"==typeof module&&module.exports?module.exports=t:e.tmpl=t}(this);var scope=["https://www.googleapis.com/auth/drive.readonly","https://www.googleapis.com/auth/drive.install"],pickerApiLoaded=!1,oauthToken,oauthData;!function(){"use strict";var e={INPUT_QUEUED:"input-event-queued",START_ADDING:"input-event-start-adding",UPLOAD_CANCELED:"input-event-upload-canceled",INPUT_DELETED:"input-event-deleted",PASSWORD_MISSING:"input-event-password-missing",INPUT_DONE:"input-event-done",INPUT_FAIL:"input-event-fail",UPLOAD_PROGRESS:"input-event-upload-progress"},t={JOB_CREATE_START:"global-event-job-create-start",JOB_CREATE_DONE:"global-event-job-create-done",JOB_CREATE_FAIL:"global-event-job-create-fail",LIMITS_TOO_MANY_INPUTS:"global-event-too-many-inputs",LIMITS_INPUT_TOO_LARGE:"global-event-input-too-large",LIMITS_JOB_TOO_LARGE:"global-event-job-too-large",LIMITS_YOUTUBE_FORBIDDEN:"global-event-youtube-forbidden"},o={EXTERNAL_URL:"type-external-url",FILE_UPLOAD:"type-upload",GDRIVE:"type-gdrive",INPUT_ID:"type-input-id",DROPBOX:"type-dropbox"},r={QUEUED:"status-queued",FAILED:"status-failed",DELETED:"status-deleted",DELETING:"status-deleting",ADDING:"status-adding",PASSWORD_MISSING:"status-password-missing",DONE:"status-done"},i={EXCEPTION:"uploader-error-EXCEPTION",UNKNOWN:"uploader-error-unknown",OVERUSE:"uploader-error-overuse",CONNECTION_PROBLEM:"uploader-error-connection-problem",BROKEN_SERVER_RESPONSE:"uploader-error-broken-server-response",NO_UPLOAD_SERVER:"uploader-error-no-upload-server",LIMITS_PAYMENT_REQUIRED:"uploader-error-payment-required",LIMITS_INPUT_TOO_LARGE:"uploader-error-file-too-large",LIMITS_TOO_MANY_INPUTS:"uploader-error-too-many-inputs",LIMITS_YOUTUBE_FORBIDDEN:"uploader-error-youtube-forbidden"},n={READY:"ready",FAILED:"failed",DOWNLOADING:"downloading",CANCELED:"canceled"},a=function(e){return"[object Array]"===Object.prototype.toString.call(e)},s=function(e){return Array.isArray?Array.isArray(e):a(e)},l={isTrue:function(e){return!0===e},isFalse:function(e){return!1===e},isNull:function(e){return null===e},isBoolean:function(e){return"boolean"==typeof e},isFunction:function(e){return"function"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isArray:function(e){return s(e)},isNumber:function(e){return"number"==typeof e},isString:function(e){return"string"==typeof e},isUUID4:function(e){return d.isString(e),/^[0-9A-F]{8}-[0-9A-F]{4}-[4][0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i.test(e)},isEmptyString:function(e){return d.isString(e),""===e},isNonEmptyString:function(e){return d.isString(e),""!==e},isEmptyArray:function(e){return d.isArray(e),0===e.length},arrayHasIndex:function(e,t){return d.isArray(e),d.isNumber(t),"undefined"!=typeof e[t]},objectHasKey:function(e,t){return d.isObject(e),d.isNotNull(t),e.hasOwnProperty(t)},objectHasValue:function(e,t){d.isObject(e);var o=!1,r=function(e,r){if(t===r)return o=!0,!1};return $.each(e,r),o},isRawJobInfo:function(e){return!!l.isObject(e)&&(!!(l.objectHasKey(e,"id")&&l.objectHasKey(e,"server")&&l.objectHasKey(e,"token")&&l.objectHasKey(e,"conversion"))&&l.isUUID4(e.id)&&l.isNonEmptyString(e.server)&&l.isNonEmptyString(e.token)&&l.isArray(e.conversion))},isRawInputInfo:function(e){return!!l.isObject(e)&&(!!(l.objectHasKey(e,"id")&&l.objectHasKey(e,"source")&&l.objectHasKey(e,"metadata"))&&l.isUUID4(e.id)&&l.isString(e.source)&&l.isObject(e.metadata))},isUploadedFileInfoObject:function(e){return!!l.isObject(e)&&(!!(l.objectHasKey(e,"id")&&l.objectHasKey(e,"completed")&&l.objectHasKey(e,"metadata")&&l.objectHasKey(e.id,"job")&&l.objectHasKey(e.id,"input"))&&l.isUUID4(e.id.job)&&l.isUUID4(e.id.input)&&l.isObject(e.metadata))},isInputStatus:function(e){return d.isNonEmptyString(e),l.objectHasValue(r,e)},isApiInputType:function(e){return d.isNonEmptyString(e),l.objectHasValue(n,e)},isInputEvent:function(t){return d.isNonEmptyString(t),l.objectHasValue(e,t)},isInputType:function(e){return d.isNonEmptyString(e),l.objectHasValue(o,e)},isGlobalEvent:function(e){return d.isNonEmptyString(e),l.objectHasValue(t,e)},isUploaderError:function(e){return d.isNonEmptyString(e),l.objectHasValue(i,e)}},d={isTrue:function(e){if(!l.isTrue(e))throw new Error("qgAssert: not true")},isFalse:function(e){if(!l.isFalse(e))throw new Error("qgAssert: not false")},isNull:function(e){if(!l.isNull(e))throw new Error("qgAssert: not null")},isNotNull:function(e){if(l.isNull(e))throw new Error("qgAssert: is null")},isBoolean:function(e){if(!l.isBoolean(e))throw new Error("qgAssert: not a boolean")},isNotBoolean:function(e){if(l.isBoolean(e))throw new Error("qgAssert: is a boolean")},isFunction:function(e){if(!l.isFunction(e))throw new Error("qgAssert: not a function")},isObject:function(e){if(!l.isObject(e))throw new Error("qgAssert: not an object")},isArray:function(e){if(!l.isArray(e))throw new Error("qgAssert: not an array")},isNotArray:function(e){if(l.isArray(e))throw new Error("qgAssert: is an array")},isNumber:function(e){if(!l.isNumber(e))throw new Error("qgAssert: not a number")},isString:function(e){if(!l.isString(e))throw new Error("qgAssert: not a string")},isUUID4:function(e){if(!l.isUUID4(e))throw new Error("qgAssert: not uuid4: "+JSON.stringify(e))},isNonEmptyString:function(e){if(l.isEmptyString(e))throw new Error("qgAssert: empty string")},isEmptyArray:function(e){if(!l.isEmptyArray(e))throw new Error("qgAssert: array is not empty")},isNonEmptyArray:function(e){if(l.isEmptyArray(e))throw new Error("qgAssert: array is empty")},arrayHasIndex:function(e,t){if(d.isArray(e),d.isNumber(t),!l.arrayHasIndex(e,t))throw new Error("qgAssert: array does not have index")},objectHasKey:function(e,t){if(!l.objectHasKey(e,t))throw new Error("qgAssert: object does not have key: "+t)},objectHasNotKey:function(e,t){if(l.objectHasKey(e,t))throw new Error("qgAssert: object does have key: "+t)},objectHasValue:function(e,t){if(!l.objectHasValue(e,t))throw new Error("qgAssert: object does not have value:"+t)},isRawJobInfo:function(e){if(d.isObject(e),!l.isRawJobInfo(e))throw new Error("qgAssert: not rawJobInfo object")},isRawInputInfo:function(e){if(d.isObject(e),!l.isRawInputInfo(e))throw new Error("qgAssert: not rawInputInfo object")},isUploadedFileInfoObject:function(e){if(d.isObject(e),!l.isUploadedFileInfoObject(e))throw new Error("qgAssert: not uploadedFileInfo object")},isInputStatus:function(e){d.isNonEmptyString(e),d.objectHasValue(r,e)},isApiInputStatus:function(e){d.isNonEmptyString(e),d.objectHasValue(n,e)},isUploaderError:function(e){if(d.isNonEmptyString(e),!l.isUploaderError(e))throw new Error("qgAssert: not valid uploaderError")},isInputEvent:function(t){d.isNonEmptyString(t),d.objectHasValue(e,t)},isInputType:function(e){d.isNonEmptyString(e),d.objectHasValue(o,e)},isGlobalEvent:function(e){d.isNonEmptyString(e),d.objectHasValue(t,e)}},u={fileSize:function(e){return"number"!=typeof e?"":e>=1073741824?(e/1073741824).toFixed(2)+" GB":e>=1048576?(e/1048576).toFixed(2)+" MB":e>=1024?(e/1024).toFixed(2)+" KB":1!==e?e.toFixed(2)+" bytes":e.toFixed(2)+" byte"},bitrate:function(e){return"number"!=typeof e?"":e>=1e9?(e/1e9).toFixed(2)+" Gbit/s":e>=1e6?(e/1e6).toFixed(2)+" Mbit/s":e>=1e3?(e/1e3).toFixed(2)+" kbit/s":e.toFixed(2)+" bit/s"},time:function(e){d.isNumber(e);var t=new Date(1e3*e),o=Math.floor(e/86400),r=o?o+"d ":"",i=("0"+t.getUTCHours()).slice(-2),n=("0"+t.getUTCMinutes()).slice(-2),a=("0"+t.getUTCSeconds()).slice(-2);return e<3600?n+":"+a:r+i+":"+n+":"+a},percentage:function(e){return d.isNumber(e),d.isTrue(e>=-.1),d.isTrue(e<=1.1),(100*e).toFixed(0)}},p={addLogData:function(e,t){try{window.qgLogger.addLogData(e,t)}catch(o){}},log:function(e,t){try{window.qgLogger.log(e,t)}catch(o){}},debug:function(e,t){try{window.qgLogger.debug(e,t)}catch(o){}},info:function(e,t){try{window.qgLogger.info(e,t)}catch(o){}},notice:function(e,t){try{window.qgLogger.notice(e,t)}catch(o){}},warning:function(e,t){try{window.qgLogger.warning(e,t)}catch(o){}},error:function(e,t){try{window.qgLogger.error(e,t)}catch(o){}},critical:function(e,t){try{window.qgLogger.critical(e,t)}catch(o){}}},c=function(e,t){d.isNonEmptyString(e),void 0===t&&(t={}),d.isObject(t);var o=tmpl(e),r=o(t);return r instanceof $?r:$("<div></div>").html(r).children()},f=function(e,t){d.isObject(e),d.isObject(t),this._uploader=e,this._apiHelper=this._uploader.getApiHelper(),this.$uploadList=null,this.oldBitrates=[],this.uiElements={},d.objectHasKey(t,"fileListSelector"),this.$uploadList=$(t.fileListSelector),d.isTrue(1===this.$uploadList.length);var o=this,r=function(e,t,r){o.callback(e,t,r)};this._uploader.registerInputEventCallback(r)};f.prototype.updateElement=function(e,t,o){d.objectHasKey(this.uiElements,e),d.isNonEmptyString(t),void 0===o&&(o={}),d.isObject(o);var r=c(t,o);r.replaceAll(this.uiElements[e].html),this.uiElements[e].html=r},f.prototype.startSpinningAnimation=function(e){$(".input-id-"+e+" i").removeClass("fa-unlock-alt"),$(".input-id-"+e+" i").addClass("fa-spin fa-spinner")},f.prototype.stopSpinningAnimation=function(e){$(".input-id-"+e+" i").removeClass("fa-spin fa-spinner"),$(".input-id-"+e+" i").addClass("fa-unlock-alt")},f.prototype.enablePwInput=function(t){d.objectHasKey(this.uiElements,t);var o=this.uiElements[t].html,i=o.find('input[type="password"]'),n=o.find(".pwbutton");if(i.keydown(function(e){13==e.keyCode&&n.trigger("click",c)}),i.hasClass("hidden")){i.removeClass("hidden"),n.removeClass("hidden");var a=this._uploader.getInput(t),s=a.getInputId();n.addClass("input-id-"+s);var l=this,u=this._uploader.getJob().getId(),c=function(){l.startSpinningAnimation(s),n.off();var o=i.val();if(""===o)return n.click(c),void l.stopSpinningAnimation(s);l._apiHelper.setPassword(u,s,o).done(function(o){l.stopSpinningAnimation(s),n.on(),n.click(c);var a=!1;try{a=o.metadata&&o.metadata.hasOwnProperty("pdf_password_valid")}catch(d){}if(a){if(!0!==o.metadata.pdf_password_valid)return i.val(""),void n.click(c);l._uploader.getInput(t).setStatus(r.DONE),l._uploader.dispatchInputEvent(e.INPUT_DONE,t)}}).fail(function(e){l.stopSpinningAnimation(s),n.on(),p.log("qgMultiUpload set password fail",e+"input id: "+s),i.val(""),n.click(c)})};n.click(c),$(".pwd").submit(function(){return!1})}},f.prototype.enableDeleteButton=function(e){d.objectHasKey(this.uiElements,e);var t=this;this.uiElements[e].html.find(".deletebutton").click(function(){t._uploader.deleteInput(e)})},f.prototype.enableFileUploadCancelButton=function(e){d.objectHasKey(this.uiElements,e);var t=this;this.uiElements[e].html.find(".cancelbutton").click(function(){t._uploader.cancelFileUpload(e)})},f.prototype.onInputAdded=function(e){d.objectHasNotKey(this.uiElements,e);var t=c("template-waiting"),o=this._uploader.getInput(e).getType();this.uiElements[e]={html:t,type:o},this.$uploadList.append(t)},f.prototype.onStartUploading=function(e){d.objectHasKey(this.uiElements,e);var t={};t[o.DROPBOX]="template-dropbox-adding",t[o.EXTERNAL_URL]="template-external-url-adding",t[o.INPUT_ID]="template-external-url-adding",t[o.GDRIVE]="template-gdrive-adding",t[o.FILE_UPLOAD]="template-file-uploading";var r=this.uiElements[e].type;d.objectHasKey(t,r);var i=t[r],n=this._uploader.getInput(e).getName(),a=this._uploader.getInput(e).getSize(),s={name:n,size:u.fileSize(a)};this.updateElement(e,i,s),r===o.FILE_UPLOAD&&this.enableFileUploadCancelButton(e)},f.prototype.onUploadDone=function(e){d.objectHasKey(this.uiElements,e);var t={};t[o.DROPBOX]="template-dropbox-added",t[o.EXTERNAL_URL]="template-external-url-added",t[o.INPUT_ID]="template-external-url-added",t[o.GDRIVE]="template-gdrive-added",t[o.FILE_UPLOAD]="template-file-uploaded";var r=this.uiElements[e].type;d.objectHasKey(t,r);var i=t[r],n=this._uploader.getInput(e).getName(),a=this._uploader.getInput(e).getSize(),s={name:n,size:u.fileSize(a)};this.updateElement(e,i,s),this.enableDeleteButton(e)},f.prototype.onPasswordMissing=function(e){d.objectHasKey(this.uiElements,e);var t={};t[o.DROPBOX]="template-dropbox-added",t[o.EXTERNAL_URL]="template-external-url-added",t[o.INPUT_ID]="template-external-url-added",t[o.GDRIVE]="template-gdrive-added",t[o.FILE_UPLOAD]="template-file-uploaded";var r=this.uiElements[e].type;d.objectHasKey(t,r);var i=t[r],n=this._uploader.getInput(e).getName(),a=this._uploader.getInput(e).getSize(),s={name:n,size:u.fileSize(a)};this.updateElement(e,i,s),this.enableDeleteButton(e),this.enablePwInput(e)},f.prototype.onUploadFail=function(e,t){d.objectHasKey(this.uiElements,e);var r={};r[o.DROPBOX]="template-dropbox-fail",r[o.EXTERNAL_URL]="template-external-url-fail",r[o.INPUT_ID]="template-external-url-fail",r[o.GDRIVE]="template-gdrive-fail",r[o.FILE_UPLOAD]="template-file-upload-fail";var n=this.uiElements[e].type;d.objectHasKey(r,n);var a=r[n],s=this._uploader.getInput(e).getName(),l=this._uploader.getInput(e).getSize(),p={name:s,size:u.fileSize(l)};"object"==typeof t&&t.hasOwnProperty("error")&&t.error===i.LIMITS_TOO_MANY_INPUTS&&(a="template-file-upload-fail-too-many-files"),this.updateElement(e,a,p)},f.prototype.onUploadDeleted=function(e){d.objectHasKey(this.uiElements,e),this.uiElements[e].html.remove(),delete this.uiElements[e]},f.prototype.onUploadCanceled=function(e){d.objectHasKey(this.uiElements,e);var t={};t[o.FILE_UPLOAD]="template-file-upload-canceled";var r=this.uiElements[e].type;d.objectHasKey(t,r);var i=t[r],n=this._uploader.getInput(e).getName(),a={name:n};this.updateElement(e,i,a)},f.prototype.getAveragedBitrate=function(e,t){"undefined"==typeof this.oldBitrates[e]&&(this.oldBitrates[e]=[]),this.oldBitrates[e].push(t);var o=this.oldBitrates[e].slice(-20);this.oldBitrates[e]=o;for(var r=0,i=0;i<o.length;i++)r+=o[i];return r/o.length},f.prototype.onUploadProgress=function(e,t){d.objectHasKey(this.uiElements,e);var o="",r=0;if("number"==typeof t)o=t+"%",r=t;else{if("object"!=typeof t)throw new Error("unknown data passed in progress event");var i=t.bytesLoaded/t.bytesTotal*100;r=Math.floor(i);var n=i.toFixed(1)+"%",a=this.getAveragedBitrate(e,t.bitrate),s=t.bytesTotal-t.bytesLoaded,l=8*s/a;o=n+" - "+u.time(l)}var p=this.uiElements[e].html;p.find(".progress").attr("aria-valuenow",r),p.find(".progress-bar").css("width",r+"%"),p.find(".progress-text").text(o)},f.prototype.callback=function(t,o,r){return d.isInputEvent(t),t===e.INPUT_QUEUED?d.objectHasNotKey(this.uiElements,o):d.objectHasKey(this.uiElements,o),t===e.INPUT_QUEUED?void this.onInputAdded(o):t===e.START_ADDING?void this.onStartUploading(o):t===e.UPLOAD_CANCELED?void this.onUploadCanceled(o):t===e.INPUT_DELETED?void this.onUploadDeleted(o):t===e.PASSWORD_MISSING?void this.onPasswordMissing(o):t===e.INPUT_DONE?void this.onUploadDone(o):t===e.INPUT_FAIL?void this.onUploadFail(o,r):t===e.UPLOAD_PROGRESS?void this.onUploadProgress(o,r):void 0};var g=function(e,t,i,n){d.isInputType(e),d.isNumber(t),d.isFunction(i),this._type=e,this._name="",this._size=0,this._inputId="",this._uploadData=null,this._isPasswordProtected=!1,this._status=r.QUEUED,this._localId=t,this._callback=i,void 0!==n&&(n.hasOwnProperty("size")&&(d.isNumber(n.size),this._size=n.size),n.hasOwnProperty("name")&&(d.isString(n.name),this._name=n.name),e===o.FILE_UPLOAD&&(d.objectHasKey(n,"uploadData"),this._uploadData=n.uploadData))};g.prototype.getType=function(){return this._type},g.prototype.getLocalId=function(){return this._localId},g.prototype.getCallback=function(){return this._callback},g.prototype.getName=function(){return this._name},g.prototype.setName=function(e){return d.isNonEmptyString(e),this._name=e,this},g.prototype.getSize=function(){return this._size},g.prototype.setSize=function(e){return d.isNumber(e),this._size=e,this},g.prototype.getInputId=function(){return this._inputId},g.prototype.setInputId=function(e){return d.isUUID4(e),this._inputId=e,this},g.prototype.getStatus=function(){return this._status},g.prototype.setStatus=function(e){return d.isInputStatus(e),this._status=e,this},g.prototype.getUploadData=function(){return d.isNotNull(this._uploadData),this._uploadData},g.prototype.isInApi=function(){var e=this._status,t=[r.ADDING,r.DELETING,r.DONE,r.PASSWORD_MISSING],o=!1;return $.each(t,function(t,r){e===r&&(o=!0)}),o},g.prototype.isQueued=function(){return this._status===r.QUEUED},g.prototype.isAdding=function(){return this._status===r.ADDING},g.prototype.isDone=function(){return this._status===r.DONE},g.prototype.isPasswordProtected=function(){return this._isPasswordProtected},g.prototype.setPasswordProtected=function(e){return d.isBoolean(e),this._isPasswordProtected=e,this},g.prototype.isPasswordMissing=function(){return this._status===r.PASSWORD_MISSING},g.prototype.isDeleting=function(){return this._status===r.DELETING};var v=function(){this.listener=[]};v.prototype.register=function(e){this.listener.push(e)},v.prototype.dispatch=function(e,t,o,r){d.isNonEmptyString(e);var i=this.listener;$.each(i,function(i,n){n(e,t,o,r)})};var h=function(){var e=window.location;return e.origin?e.origin:e.protocol+"//"+e.hostname+(e.port&&":"+e.port)},m=function(e){this._isValid=!1,this._data={},l.isRawJobInfo(e)&&(this._isValid=!0,this._data=e)};m.prototype.isValid=function(){return this._isValid},m.prototype.getId=function(){return d.isTrue(this._isValid),this._data.id},m.prototype.getConversionId=function(){d.isTrue(this._isValid);try{return this._data.conversion[0].id}catch(e){}return null},m.prototype.getToken=function(){return d.isTrue(this._isValid),this._data.token},m.prototype.getServer=function(){return d.isTrue(this._isValid),this._data.server},m.prototype.getUploadUrl=function(){return d.isTrue(this._isValid),this.getServer()+"/upload-file/"+this.getId()},m.prototype.getUploadUrlBase64=function(){return d.isTrue(this._isValid),this.getServer()+"/upload-base64/"+this.getId()},m.prototype.getRedirectedUploadUrl=function(){d.isTrue(this._isValid);var e=this.getServer().match(/^[^:]*:\/\/([^.]+)\.([^\/]+)(\/.*)$/);if(null===e)return p.error("Can not create redirect upload url",this.getServer()),this.getUploadUrl();var t=e[1],o=e[3];return h()+"/upload-redirect/"+t+o+"/upload-file/"+this.getId()},m.prototype.getInput=function(e){d.isTrue(this._isValid),d.isUUID4(e);var t=null;return $.each(this._data.input,function(o,r){r.id===e&&(t=r)}),t},m.prototype.getInputError=function(e){d.isTrue(this._isValid),d.isUUID4(e);var t=null;return $.each(this._data.errors,function(o,r){r.hasOwnProperty("id_source")&&r.id_source===e&&(t=r)}),t},m.prototype.getInputWarning=function(e){d.isTrue(this._isValid),d.isUUID4(e);var t=null;return $.each(this._data.warnings,function(o,r){r.hasOwnProperty("id_source")&&r.id_source===e&&(t=r)}),t},m.prototype.isInputFinished=function(e){d.isTrue(this._isValid),d.isUUID4(e);var t=this.getInput(e);return l.isString(t.status)?t.status===n.READY:(d.objectHasKey(t,"size"),t.size>0)},m.prototype.getRawJobInfo=function(){return d.isTrue(this._isValid),this._data};var b=function(e,t){this._api=e,this._jobInfoHelper=null,this._isJobCreationFailed=!1,this._isCreating=!1,this._isUploadFallbackFeatureEnabled=!1,t&&!0===t.enableUploadFallback&&(this._isUploadFallbackFeatureEnabled=!0),this._jobNeedsUploadFallback=!1};b.prototype.create=function(e){d.isNull(this._jobInfoHelper),d.isFalse(this._isCreating);var t=$.Deferred(),o=this;return o._isCreating=!0,this._api.createJob(e).done(function(e){o._jobInfoHelper=new m(e),t.resolve(e),o._isCreating=!1}).fail(function(e){o._isJobCreationFailed=!0,t.resolve(e),o._isCreating=!1}),t},b.prototype.createWithServerCheck=function(e){d.isNull(this._jobInfoHelper),d.isFalse(this._isCreating);var t=$.Deferred(),o=this;return o._isCreating=!0,this._api.createJobWithUploadServerCheck(e,2).done(function(e,r){o._jobInfoHelper=new m(e),o._isCreating=!1,!1===r&&!0===o._isUploadFallbackFeatureEnabled&&(o._jobNeedsUploadFallback=!0),t.resolve(e)}).fail(function(e){o._isJobCreationFailed=!0,t.reject(e),o._isCreating=!1}),t},b.prototype.isCreated=function(){return null!==this._jobInfoHelper},b.prototype.isCreating=function(){return this._isCreating},b.prototype.isFailed=function(){return this._isJobCreationFailed},b.prototype.jobNeedsUploadFallback=function(){return this._jobNeedsUploadFallback},b.prototype.getId=function(){return d.isFalse(this._isJobCreationFailed),null===this._jobInfoHelper?null:this._jobInfoHelper.getId()},b.prototype.getConversionId=function(){return d.isFalse(this._isJobCreationFailed),this._jobInfoHelper.getConversionId()},b.prototype.getUploadToken=function(){return d.isFalse(this._isJobCreationFailed),this._jobInfoHelper.getToken()},b.prototype.getServerUrl=function(){return d.isFalse(this._isJobCreationFailed),this._jobInfoHelper.getServer()},b.prototype.getUploadUrl=function(){return d.isFalse(this._isJobCreationFailed),this._jobInfoHelper.getUploadUrl()},b.prototype.getRedirectUploadUrl=function(){return d.isFalse(this._isJobCreationFailed),this._jobInfoHelper.getRedirectedUploadUrl()},b.prototype.getJobInfo=function(){d.isFalse(this._isJobCreationFailed),d.isNotNull(this._jobInfoHelper);var e=$.Deferred(),t=this;return this._api.getJobInfo(t.getId()).done(function(o){d.isRawJobInfo(o),t._jobInfoHelper=new m(o),e.resolve(o)}).fail(function(t){d.isUploaderError(t),e.reject(t)}),e},b.prototype.getCachedJobInfo=function(){d.isFalse(this._isJobCreationFailed),d.isNotNull(this._jobInfoHelper);var e=$.Deferred(),t=this;return this._api.getCachedJobInfo(t.getId()).done(function(o){d.isRawJobInfo(o),t._jobInfoHelper=new m(o),e.resolve(o)}).fail(function(t){d.isUploaderError(t),e.reject(t)}),e},b.prototype.getRawJobInfo=function(){return d.isFalse(this._isJobCreationFailed),this._jobInfoHelper.getRawJobInfo()},b.prototype.waitForRemoteInput=function(e){var t=this._jobInfoHelper.getId();return this._api.waitForRemoteInput(t,e)};var _=function(e,t){d.isArray(e),d.isFunction(t);var o=0;return $.each(e,function(e,r){t(r)&&o++}),o},y=function(e){this._inputs=[],this._maxNumberOfInputs=60,e.hasOwnProperty("maxNumberOfInputs")&&(this._maxNumberOfInputs=e.maxNumberOfInputs)};y.prototype._assertThatInputExists=function(e){d.arrayHasIndex(this._inputs,e)},y.prototype.getInput=function(e){return d.isNumber(e),this._assertThatInputExists(e),this._inputs[e]},y.prototype.getInputs=function(){return this._inputs},y.prototype.addInput=function(e,t,o){d.isInputType(e),d.isFunction(t);var r=this._inputs.length;return this._inputs.push(new g(e,r,t,o)),r},y.prototype.isInputLimitReached=function(){var e=this.getNumberOfInputsInApi();return d.isFalse(e>this._maxNumberOfInputs),e>=this._maxNumberOfInputs},y.prototype.getNumberOfAllInputs=function(){return this._inputs.length},y.prototype.getNumberOfQueuedInputs=function(){var e=function(e){return e.isQueued()};return _(this._inputs,e)},y.prototype.getNumberOfInputsInApi=function(){var e=function(e){return e.isInApi()};return _(this._inputs,e)},y.prototype.getNumberOfDoneInputs=function(){var e=function(e){return e.isDone()};return _(this._inputs,e)},y.prototype.getNumberOfDeletingInputs=function(){var e=function(e){return e.isDeleting()};return _(this._inputs,e)},y.prototype.getNumberOfActiveFileUploads=function(){var e=function(e){return e.getType()===o.FILE_UPLOAD&&e.getStatus()===r.ADDING};return _(this._inputs,e)},y.prototype.getNumberOfPasswordMissing=function(){var e=function(e){return e.getStatus()===r.PASSWORD_MISSING};return _(this._inputs,e)},y.prototype.getBytesInJob=function(){var e=0,t=function(t,o){(o.isAdding()||o.isDone()||o.isPasswordMissing())&&(e+=o.getSize())};return $.each(this._inputs,t),e};var I=function(e,t){this._uploader=e};I.prototype.add=function(t){d.isString(t);var n=this._uploader,a=function(o){var a=$.Deferred(),s=n.getJob().getId();if(n.getInput(o).setStatus(r.ADDING),n.getInput(o).setName(t),n.dispatchInputEvent(e.START_ADDING,o),""===t.trim()){var l={error:i.UNKNOWN};return n.failInput(o,l),a.resolve(),a}return n.getApiHelper().addExternalUrl(s,t).done(function(e){d.isRawInputInfo(e);var t=e.id;n.getInput(o).setInputId(t),n.waitForRemoteInput(o),a.resolve()}).fail(function(e){d.isUploaderError(e);var t={error:e};n.failInput(o,t),a.resolve()}),a},s={name:t};this._uploader._queueInput(o.EXTERNAL_URL,a,s)};var w=function(e,t){this._uploader=e,this._maxFileSize=t.maxFileSize};w.prototype.add=function(){if(!window.hasOwnProperty("Dropbox"))return p.log("qgMultiUpload dropbox fail","dropbox JS missing"),void alert("Dropbox could not be initialized, please try again later!");var n=this._uploader,a=this,s=function(e){$.each(e,function(e,t){var o=t.link,r=0,i="Dropbox";t.hasOwnProperty("bytes")&&"number"==typeof t.bytes&&(r=t.bytes),t.hasOwnProperty("name")&&(i=t.name),l(o,r,i)})},l=function(s,l,u){var c=function(o){var c=$.Deferred();n.getInput(o).setName(u),n.getInput(o).setSize(l);var f=n.getBytesInJob()+l;if(f>a._maxFileSize){var g={error:i.LIMITS_INPUT_TOO_LARGE,size:f};return p.log("qgMultiUpload dropbox fail",{info:"file too large",filename:u,file_size:l,max_file_size:a._maxFileSize}),n.failInput(o,g),n.dispatchGlobalEvent(t.LIMITS_INPUT_TOO_LARGE),c.resolve()}var v=n.getJob().getId();return n.getInput(o).setStatus(r.ADDING),n.dispatchInputEvent(e.START_ADDING,o),n.getApiHelper().addExternalUrl(v,s).done(function(e){d.isRawInputInfo(e);var t=e.id;n.getInput(o).setInputId(t),n.waitForRemoteInput(o),c.resolve()}).fail(function(e){d.isUploaderError(e);var t={error:e};n.failInput(o,t),c.resolve()}),c},f={name:u,size:l};n._queueInput(o.DROPBOX,c,f)},u={success:s,linkType:"direct",multiselect:!0};Dropbox.choose(u)};var O={createUUID4:function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}},U={JOB_CAN_NOT_BE_MODIFIED:2,FILE_TOO_LARGE:3,EMPTY_OR_INVALID_FILE:5,PROBLEM_UPLOADING_FILE:6,UNSUPPORTED_CONTENT_RANGE_HEADER:8,SUM_OF_UPLOADS_TOO_LARGE:34,UNKNOWN:99},E={baseChunkSize:1e6,minChunkSize:1e5,maxChunkSize:1e8,speedModifier:3,maxSpeedModifier:5,increaseChunkSpeed:function(){E.limitSpeed(++E.speedModifier)},resetChunkSpeed:function(){E.speedModifier=1},getDynamicChunkSize:function(e){var t=e.progress();if(0===t.loaded){var o=E.baseChunkSize;return e.pgRetries>0&&(o=E.minChunkSize),o}if(1===E.speedModifier)return E.minChunkSize;var r=parseInt(t.bitrate)*E.speedModifier;return E.limitChunk(r)},limitChunk:function(e){return Math.max(E.minChunkSize,Math.min(e,E.maxChunkSize))},limitSpeed:function(e){E.speedModifier=Math.max(1,Math.min(e,E.maxSpeedModifier))}},N=function(e,t){d.isObject(t),this._uploader=e,this._maxFileSize=t.maxFileSize,this._maxRetries=30,this._retryTimeout=500,this._enablePdfPasswords=!0===t.enablePdfPasswords,this._isUploadFallbackFeatureEnabled=!0===t.enableUploadFallback,d.isNonEmptyString(t.fileUploadInputId),d.isTrue(1===$(t.fileUploadInputId).length);var o={singleFileUploads:!0,sequentialUploads:!1,maxChunkSize:E.getDynamicChunkSize,autoUpload:!1,progressInterval:500,messages:{unknownError:"Unknown error",maxNumberOfFiles:"Maximum number of files exceeded",acceptFileTypes:"File type not allowed",maxFileSize:"File is too large",minFileSize:"File is too small",uploadedBytes:"Uploaded bytes exceed file size"}},r=this;$(t.fileUploadInputId).fileupload(o).bind("fileuploadadd",function(e,t){r._processFileUploadAdd(e,t)}).bind("fileuploadsubmit",function(e,t){return r._processFileUploadSubmit(e,t)}).bind("fileuploadsend",function(e,t){}).bind("fileuploaddone",function(e,t){r._processFileUploadDone(e,t)}).bind("fileuploadfail",function(e,t){r._processFileUploadFail(e,t)}).bind("fileuploadalways",function(e,t){}).bind("fileuploadprogress",function(e,t){r._processFileUploadProgress(e,t)}).bind("fileuploadprogressall",function(e,t){}).bind("fileuploadstart",function(e){}).bind("fileuploadstop",function(e){}).bind("fileuploadchange",function(e,t){}).bind("fileuploadpaste",function(e,t){}).bind("fileuploaddrop",function(e,t){}).bind("fileuploaddragover",function(e){}).bind("fileuploadchunksend",function(e,t){}).bind("fileuploadchunkdone",function(e,t){}).bind("fileuploadchunkfail",function(e,t){}).bind("fileuploadchunkalways",function(e,t){E.increaseChunkSpeed()})};N.prototype._processFileUploadAdd=function(n,a){var s=a.files[0].name,l=a.files[0].size,d=this,u=this._uploader,c=function(o){var n=$.Deferred();u.getInput(o).setName(s),u.getInput(o).setSize(l);var c=u.getBytesInJob()+l;if(c>d._maxFileSize){var f={error:i.LIMITS_INPUT_TOO_LARGE,size:c};return p.log("qgMultiUpload fileUpload fail file too large",{info:"file too large",filename:s,total_size:c,file_size:l,max_file_size:d._maxFileSize}),u.failInput(o,f),u.dispatchGlobalEvent(t.LIMITS_INPUT_TOO_LARGE),n.resolve()}var g=u.getJob();return a.url=g.getUploadUrl(),d._isUploadFallbackFeatureEnabled&&g.jobNeedsUploadFallback()&&(a.url=g.getRedirectUploadUrl()),a.localId=o,u.getInput(o).setStatus(r.ADDING),u.dispatchInputEvent(e.START_ADDING,o),a.headers={"X-Oc-Upload-Uuid":O.createUUID4(),"X-Oc-Token":u.getJob().getUploadToken()},a.pgRetries=0,p.log("qgMultiUpload fileUpload start","name: "+s),a.submit(),n.resolve(),n},f={size:l,name:s,uploadData:a};u._queueInput(o.FILE_UPLOAD,c,f)},N.prototype._processFileUploadSubmit=function(e,t){return!0},N.prototype._successfulFileuploadHelper=function(t){var o=t.result;d.isUploadedFileInfoObject(o);var i=t.localId,n=o.id.input;this._uploader.getInput(i).setInputId(n);var a=t.files[0].name,s=t.files[0].size;this._uploader.getInput(i).setName(a),this._uploader.getInput(i).setSize(s);var l=!1;try{l=!0===o.metadata.pdf_has_user_password}catch(u){}this._enablePdfPasswords&&l?(this._uploader.getInput(i).setStatus(r.PASSWORD_MISSING),this._uploader.dispatchInputEvent(e.PASSWORD_MISSING,i)):(this._uploader.getInput(i).setStatus(r.DONE),this._uploader.dispatchInputEvent(e.INPUT_DONE,i)),t.pgRetries>0&&p.log("qgMultiUpload fileUpload info",{info:"upload needed retries",input_id:n}),p.log("qgMultiUpload fileUpload done",{input_id:n,filename:a})},N.prototype._processFileUploadDone=function(e,t){var o=!1;if("string"==typeof t.result){p.log("qgMultiUpload fileUpload info",{info:"sever response was not parsed by browser",server_response:JSON.stringify(t.result)});try{t.result=JSON.parse(t.result)}catch(e){p.log("qgMultiUpload fileUpload fail",{info:"server response could not be parsed as JSON",server_response:JSON.stringify(t.result)})}}try{o=!0===t.result.completed}catch(r){}o?this._successfulFileuploadHelper(t):(p.log("qgMultiUpload fileUpload fail",{info:"api error: server response: "+JSON.stringify(t.result)}),this._uploader.failInput(t.localId))},N.prototype._logRetryInfo=function(e){var t=0,o="",r="";try{r="current retry: "+e.pgRetries,r+=" | uploaded bytes: "+e.uploadedBytes,r+=" | file size: "+e.files[0].size,e.hasOwnProperty("jqXHR")||(r+=" | jqXHR missing!");try{e.jqXHR.hasOwnProperty("status")&&(r+=" | status code: "+e.jqXHR.status)}catch(i){}try{e.jqXHR.hasOwnProperty("responseText")&&("string"==typeof e.jqXHR.responseText?r+=" | response text: "+e.jqXHR.responseText.substr(0,512):r+=" | response text: NOT A STRING "+JSON.stringify(e.jqXHR.responseText))}catch(i){}try{e.jqXHR.hasOwnProperty("responseJSON")&&("object"==typeof e.jqXHR.responseJSON?r+=" | response json: "+JSON.stringify(e.jqXHR.responseJSON):r+=" | response json: NOT AN OBJECT "+JSON.stringify(e.jqXHR.responseJSON))}catch(i){}e.hasOwnProperty("url")?"string"!=typeof e.url?r+=" | url: URL NOT A STRING":""===e.url?r+=" | url: EMPTY URL":r+=' | url: "'+e.url+'"':r+=" | url: NO URL",e.hasOwnProperty("headers")?r+=" | headers: "+JSON.stringify(e.headers):r+=" | headers: NO HEADERS",t=e.textStatus,o=e.errorThrown}catch(i){r="exception during logging",i.hasOwnProperty("message")&&(r+=": "+i.message)}p.log("qgMultiUpload fileUpload retry",{info:r,ajax_status:t,ajax_error:o})},N.prototype._logFailInfo=function(e){var t=0,o="",r="";try{r="retries: "+e.pgRetries,r+=" | uploaded bytes: "+e.uploadedBytes;try{r+=" | file size: "+e.files[0].size}catch(i){}try{r+=" | server response: "+e.jqXHR.responseText.substr(0,250)}catch(i){}try{r+=" | server error message: "+e.jqXHR.responseJSON.error.substr(0,250)}catch(i){}try{r+=" | status code: "+e.jqXHR.status}catch(i){}t=e.textStatus,o=e.errorThrown}catch(i){r="exception during logging",i.hasOwnProperty("message")&&(r+=": "+i.message)}p.log("qgMultiUpload fileUpload fail",{info:r,ajax_status:t,ajax_error:o})},N.prototype._processFileUploadFail=function(e,t){if(E.resetChunkSpeed(),"abort"===t.errorThrown)return void p.log("qgMultiUpload fileUpload abort",{ajax_status:t.textStatus,ajax_error:t.errorThrown});var o=!1;try{o="object"==typeof t.jqXHR.responseJSON}catch(e){}var r=null;try{r=t.jqXHR.responseJSON.error_code}catch(e){}var n=r===U.PROBLEM_UPLOADING_FILE;if(!o||n){if(t.uploadedBytes<t.files[0].size&&t.pgRetries<this._maxRetries){if(this._isUploadFallbackFeatureEnabled&&0===t.uploadedBytes&&3===t.pgRetries){p.log("qgMultiUpload fileUpload info","use upload redirect");var a=this._uploader.getJob();t.url=a.getRedirectUploadUrl()}t.pgRetries+=1,this._logRetryInfo(t);var s=function(){t.submit()};return void window.setTimeout(s,t.pgRetries*this._retryTimeout)}}var l={error:i.UNKNOWN};r!==U.FILE_TOO_LARGE&&r!==U.SUM_OF_UPLOADS_TOO_LARGE||(l.error=i.LIMITS_INPUT_TOO_LARGE),this._logFailInfo(t),this._uploader.failInput(t.localId,l)},N.prototype._processFileUploadProgress=function(t,o){var r={bitrate:o.bitrate,bytesLoaded:o.loaded,bytesTotal:o.total};this._uploader.dispatchInputEvent(e.UPLOAD_PROGRESS,o.localId,r)};var S,D=!1,C=["https://www.googleapis.com/auth/drive.readonly","https://www.googleapis.com/auth/drive.install"],A=function(e,t){this._uploader=e,this._oauthToken=null,this._maxFileSize=t.maxFileSize,this._clientId=null,this._developerKey=null,l.isNonEmptyString(t.gdriveClientId)&&l.isNonEmptyString(t.gdriveDeveloperKey)&&(this._clientId=t.gdriveClientId,this._developerKey=t.gdriveDeveloperKey)};A.prototype.add=function(n,a,s,l){function u(){d.isNonEmptyString(v._clientId),window.gapi.auth.authorize({client_id:v._clientId,scope:C,immediate:!1},f)}function c(){D=!0,g()}function f(e){e&&!e.error&&(v._oauthToken=e.access_token,g())}function g(){if(D&&v._oauthToken){d.isNonEmptyString(v._developerKey);var e=new google.picker.View(google.picker.ViewId.DOCS);S=(new google.picker.PickerBuilder).enableFeature(google.picker.Feature.NAV_HIDDEN).enableFeature(google.picker.Feature.MULTISELECT_ENABLED).setOAuthToken(v._oauthToken).addView(e).addView(new google.picker.DocsUploadView).setDeveloperKey(v._developerKey).setCallback(m).build(),S.setVisible(!0)}}if(null!==this._clientId&&null!==this._developerKey){var v=this,h=this._uploader,m=function(e){"undefined"!=typeof e.action&&"picked"===e.action&&"undefined"!=typeof e.docs&&$.each(e.docs,function(e,t){var o=0,r="gDrive";t.hasOwnProperty("sizeBytes")&&"number"==typeof t.sizeBytes&&(o=t.sizeBytes),t.hasOwnProperty("name")&&(r=t.name),b(v._oauthToken,r,o,t.id,t.mimeType)})},b=function(n,a,s,l,d){var u=function(o){var u=$.Deferred();h.getInput(o).setName(a),h.getInput(o).setSize(s);var c=h.getBytesInJob()+s;if(c>v._maxFileSize){var f={error:i.LIMITS_INPUT_TOO_LARGE,size:c};return p.log("qgMultiUpload gdrive fail",{info:"file too large",filename:a,file_size:s,max_file_size:v._maxFileSize}),h.failInput(o,f),h.dispatchGlobalEvent(t.LIMITS_INPUT_TOO_LARGE),u.resolve()}var g=h.getJob().getId();return h.getInput(o).setStatus(r.ADDING),h.dispatchInputEvent(e.START_ADDING,o),h.getApiHelper().addInput(g,{type:"gdrive_picker",source:l,credentials:{token:n},filename:a,content_type:d}).done(function(e){var t=e.id;h.getInput(o).setInputId(t),h.waitForRemoteInput(o),u.resolve()}).fail(function(e){var r={error:i.UNKNOWN};e.hasOwnProperty("code")&&e.hasOwnProperty("text")&&(50!==e.code&&34!==e.code||(r.error=i.LIMITS_INPUT_TOO_LARGE)),p.log("qgMultiUpload gdrive fail",{info:"file too large",filename:a,file_size:s,max_file_size:v._maxFileSize}),h.failInput(o,r),h.dispatchGlobalEvent(t.LIMITS_INPUT_TOO_LARGE),u.resolve()}),u},c={name:a,size:s};h._queueInput(o.GDRIVE,u,c)};if("string"==typeof n&&"string"==typeof a&&"string"==typeof s&&"string"==typeof l)return void b(a,n,0,s,l);var _=window.hasOwnProperty("gapi"),y=_&&window.gapi.hasOwnProperty("load");return _&&y?void 0===S?void function(){window.gapi.load("auth",{callback:u}),window.gapi.load("picker",{callback:c})}():void S.setVisible(!0):(this._log("qgMultiUpload gdrive fail","gapi missing"),void alert("Google Drive could not be initialized, please try again later!"))}};var F=function(e,t){this._uploader=e};F.prototype.add=function(t){d.isString(t);var i=this._uploader,n=function(o){var n=$.Deferred(),a=i.getJob().getId();return i.getInput(o).setStatus(r.ADDING),i.getInput(o).setName(t),i.dispatchInputEvent(e.START_ADDING,o),i.getApiHelper().addInputId(a,t).done(function(e){d.isRawInputInfo(e);var t=e.id;i.getInput(o).setInputId(t),i.waitForRemoteInput(o),n.resolve()}).fail(function(e){d.isUploaderError(e);var t={error:e};i.failInput(o,t),n.resolve()}),n};this._uploader._queueInput(o.INPUT_ID,n)};var x=function(e){if(d.isString(e),""===(e=e.replace(/\s/g,"")))return!1;var t="";try{var o=document.createElement("a");o.href=e,t=o.hostname,t=t.toLowerCase()}catch(r){return!1}return-1!==t.indexOf("youtube.com")||-1!==t.indexOf("youtu.be")||-1!==t.indexOf("googlevideo.com")},j=function(e,t){d.isObject(t),this._apiHelper=e,this._isEnabled=!0,this._inputList=new y(t),this._inputEventHandler=new v,this._globalEventHandler=new v,this._job=new b(e,t),this._addExternalUrlHelper=new I(this,t),this._addDropboxHelper=new w(this,t),this._addGdriveHelper=new A(this,t),this._addInputIdHelper=new F(this,t),this._addFileUploadHelper=new N(this,t),this._queueIsBeingProcessed=!1,this._sentLogAboutMaxInputs=!1,this._maxFileSize=8589934592,l.isNumber(t.maxFileSize)&&(this._maxFileSize=t.maxFileSize),this._blockYouTubeUrls=!0,this._enablePdfPasswords=!0===t.enablePdfPasswords,t.hasOwnProperty("blockYouTubeUrls")&&(this._blockYouTubeUrls=t.blockYouTubeUrls),this._jobData={},t.hasOwnProperty("jobData")&&(this._jobData=t.jobData)};j.prototype.enable=function(){this._isEnabled=!0},j.prototype.disable=function(){this._isEnabled=!1},j.prototype.isEnabled=function(){return this._isEnabled},j.prototype.registerInputEventCallback=function(e){d.isFunction(e),this._inputEventHandler.register(e)},j.prototype.dispatchInputEvent=function(e,t,o){d.isInputEvent(e),this._inputEventHandler.dispatch(e,t,o)},j.prototype.registerGlobalEventCallback=function(e){d.isFunction(e),this._globalEventHandler.register(e)},j.prototype.dispatchGlobalEvent=function(e,t,o){d.isGlobalEvent(e),this._globalEventHandler.dispatch(e,t,o)},j.prototype.getJob=function(){return this._job},j.prototype.getInput=function(e){return this._inputList.getInput(e)},j.prototype.getApiHelper=function(){return this._apiHelper},j.prototype._queueInput=function(r,n,a){if(d.isInputType(r),d.isFunction(n),this._isEnabled&&!this._job.isFailed()){var s=this._inputList.addInput(r,n,a);this.dispatchInputEvent(e.INPUT_QUEUED,s);var u=this.getInput(s),c=u.getSize();if(c>this._maxFileSize){var f={error:i.LIMITS_INPUT_TOO_LARGE,size:c};return p.log("qgMultiUpload queue fail",{info:"file too large",filename:u.getName(),file_size:c,max_file_size:this._maxFileSize}),this.failInput(s,f),void this.dispatchGlobalEvent(t.LIMITS_INPUT_TOO_LARGE)}if(this._blockYouTubeUrls&&r===o.EXTERNAL_URL){var g=u.getName();if(x(g)){var v={error:i.LIMITS_YOUTUBE_FORBIDDEN};return this.failInput(s,v),void this.dispatchGlobalEvent(t.LIMITS_YOUTUBE_FORBIDDEN)}}if(!this._job.isCreating()){if(this._job.isCreated())return void(this._queueIsBeingProcessed||this._submitNextQueuedInput());var h=this;this.dispatchGlobalEvent(t.JOB_CREATE_START),this._job.createWithServerCheck(this._jobData).done(function(e){if(d.isRawJobInfo(e),p.addLogData("job_id",h._job.getId()),e.hasOwnProperty("sat"))try{var o=e.sat.product.constraints.job,r=o.general.max_size;"string"==typeof r&&(r=parseInt(r)),l.isNumber(r)&&!isNaN(r)&&r>0&&(h._maxFileSize=r)}catch(i){}h.dispatchGlobalEvent(t.JOB_CREATE_DONE),h._submitNextQueuedInput()}).fail(function(e){d.isUploaderError(e),h._failQueuedInputs(),h.dispatchGlobalEvent(t.JOB_CREATE_FAIL)})}}},j.prototype._submitNextQueuedInput=function(){if(this._queueIsBeingProcessed=!0,this.isInputLimitReached())return this._queueIsBeingProcessed=!1,this._failQueuedInputs(i.LIMITS_TOO_MANY_INPUTS),this.dispatchGlobalEvent(t.LIMITS_TOO_MANY_INPUTS),void(this._sentLogAboutMaxInputs||(p.log("qgMultiUpload processQueuedInputs fail max number of inputs"),this._sentLogAboutMaxInputs=!0));var e=this._getNextQueuedInput();if(null===e)return void(this._queueIsBeingProcessed=!1);var o=this._inputList.getInput(e),r=o.getSize()>this._maxFileSize,n=o.getSize()+this._inputList.getBytesInJob()>this._maxFileSize;if(r||n){var a={error:i.LIMITS_INPUT_TOO_LARGE,size:o.getSize()};return p.log("qgMultiUpload queue fail",{info:"file too large",filename:o.getName(),file_size:o.getSize(),max_file_size:this._maxFileSize}),(this.failInput(e,a),this.dispatchGlobalEvent(t.LIMITS_INPUT_TOO_LARGE),null===this._getNextQueuedInput())?void(this._queueIsBeingProcessed=!1):void this._submitNextQueuedInput()}var s=o.getCallback(),l=this;s(o.getLocalId()).always(function(){if(null===l._getNextQueuedInput())return void(l._queueIsBeingProcessed=!1);l._submitNextQueuedInput()})},j.prototype._getNextQueuedInput=function(){var e=null,t=this._inputList.getInputs();return $.each(t,function(t,o){o.getStatus()===r.QUEUED&&null===e&&(e=t)}),e},j.prototype.failInput=function(t,o){void 0===o&&(o={error:i.UNKNOWN}),this.getInput(t).setStatus(r.FAILED),this.dispatchInputEvent(e.INPUT_FAIL,t,o)},j.prototype.deleteInput=function(t){if(this._isEnabled){var o=this.getInput(t),i=o.getStatus();if(i!==r.DELETING){if(!function(){return i===r.PASSWORD_MISSING||i===r.DONE}())throw new Error("wrong state for being deleted");o.setStatus(r.DELETING);var n=this;this._apiHelper.deleteInput(this._job.getId(),o.getInputId()).done(function(){o.setStatus(r.DELETED),n.dispatchInputEvent(e.INPUT_DELETED,t)}).fail(function(e){d.isUploaderError(e),o.setStatus(i)})}}},j.prototype.cancelFileUpload=function(t){if(this._isEnabled){var i=this.getInput(t);if(i.getType()!==o.FILE_UPLOAD)throw new Error("only file uploads can be canceled");if(i.getStatus()!==r.ADDING)return void p.log("qgMultiUpload fileUpload wrong state while canceling");i.getUploadData().abort(),i.setStatus(r.DELETED),this.dispatchInputEvent(e.UPLOAD_CANCELED,t)}},j.prototype._failQueuedInputs=function(e){var t={error:i.UNKNOWN};void 0!==e&&(d.isUploaderError(e),t.error=e);var o=this,n=this._inputList.getInputs();$.each(n,function(e,i){i.getStatus()===r.QUEUED&&o.failInput(e,t)})},j.prototype.getBytesInJob=function(){return this._inputList.getBytesInJob()},j.prototype.getNumberOfAllInputs=function(){return this._inputList.getNumberOfAllInputs()},j.prototype.getNumberOfQueuedInputs=function(){return this._inputList.getNumberOfQueuedInputs()},j.prototype.getNumberOfInputsInApi=function(){return this._inputList.getNumberOfInputsInApi()},j.prototype.getNumberOfDeletingInputs=function(){return this._inputList.getNumberOfDeletingInputs()},j.prototype.getNumberOfActiveFileUploads=function(){return this._inputList.getNumberOfActiveFileUploads()},j.prototype.getNumberOfPasswordMissing=function(){return this._inputList.getNumberOfPasswordMissing()},j.prototype.isInputLimitReached=function(){return this._inputList.isInputLimitReached()},j.prototype.waitForRemoteInput=function(t){var o=this.getInput(t).getInputId(),i=this;this._job.waitForRemoteInput(o).done(function(o){d.isRawInputInfo(o),i.getInput(t).setSize(o.size),i.getInput(t).setName(o.filename);var n=!1;try{n=!0===o.metadata.pdf_has_user_password}catch(a){}i._enablePdfPasswords&&n?(i.getInput(t).setStatus(r.PASSWORD_MISSING),i.dispatchInputEvent(e.PASSWORD_MISSING,t)):(i.getInput(t).setStatus(r.DONE),i.dispatchInputEvent(e.INPUT_DONE,t))}).fail(function(e){d.isUploaderError(e);var o={error:e};i.failInput(t,o)})},j.prototype.addInputId=function(e){this._addInputIdHelper.add(e)},j.prototype.addExternalUrl=function(e){this._addExternalUrlHelper.add(e)},j.prototype.addExternalUrls=function(e){d.isArray(e);var t=this._addExternalUrlHelper;e.forEach(function(e){t.add(e)})},j.prototype.addDropbox=function(){this._addDropboxHelper.add()},j.prototype.addGdrive=function(e,t,o,r){this._addGdriveHelper.add(e,t,o,r)},j.prototype.startJob=function(e){d.isNonEmptyString(e);var t=this._job.getId();return this._apiHelper.startJob(t,e)},j.prototype.savePreset=function(e){return this._apiHelper.savePreset(e)};var q=function(e){this._isValid=!1,this._rawData={},l.isRawInputInfo(e)&&(this._isValid=!0,this._rawData=e)};q.prototype.isValid=function(){return this._isValid},q.prototype.getId=function(){return d.isTrue(this._isValid),this._rawData.id},q.prototype.getSize=function(){return d.isTrue(this._isValid),this._rawData.size},q.prototype.getStatus=function(){return d.isTrue(this._isValid),d.isApiInputStatus(this._rawData.status),this._rawData.status},q.prototype.isFinished=function(){d.isTrue(this._isValid);var e=this._rawData;return l.isString(e.status)?e.status===n.READY:e.size>0};var P=function(e,t){d.isObject(t),this._api=e};P.prototype.createJob=function(e){var t=this._api;l.isObject(e)||(e={});var o=$.extend({},t.baseAjaxOptions);o.url="/api/jobs",o.data=e;var r=$.Deferred();return t.ajaxWrapper.postJson(o).done(function(e,o,n){var a=new m(e);if(!a.isValid())return p.log("qgApiHelper createJob fail broken response",{info:"response: "+JSON.stringify(e)}),void r.reject(i.BROKEN_SERVER_RESPONSE);var s=a.getId();t.jobCache.setData(s,e),p.addLogData("job_id",s),p.log("qgApiHelper createJob done"),r.resolve(e)}).fail(function(e,t,o){402===e.status&&(window.allowLeave=!0,window.location=sat.pricing+"?limit=2"),r.reject(i.CONNECTION_PROBLEM)}),r},P.prototype.getJobInfo=function(e){d.isUUID4(e);var t=this._api,o=$.Deferred(),r=$.extend({},t.baseAjaxOptions);return r.url="/api/jobs/"+e,t.numberOfCurrentJobInfoRequests.hasOwnProperty(e)||(t.numberOfCurrentJobInfoRequests[e]=0),t.numberOfCurrentJobInfoRequests[e]++,t.ajaxWrapper.get(r).done(function(r,n,a){if(t.numberOfCurrentJobInfoRequests[e]--,r=t.fixOldBrowser(r),!new m(r).isValid())return p.log("qgApiHelper getJobInfo fail broken response",{info:"response: "+JSON.stringify(r)}),void o.reject(i.BROKEN_SERVER_RESPONSE);t.jobCache.setData(e,r),o.resolve(r)}).fail(function(r,n,a){t.numberOfCurrentJobInfoRequests[e]--,p.log("qgApiHelper getJobInfo fail connection problem",r.status),402===r.status&&(window.allowLeave=!0,window.location=sat.pricing+"?limit=2"),o.reject(i.CONNECTION_PROBLEM)}),o},P.prototype.addInput=function(e,t){d.isUUID4(e),d.isObject(t),d.isNotArray(t),d.objectHasKey(t,"type");var o=this._api,r=$.Deferred(),n=$.extend({},o.baseAjaxOptions);return n.url="/api/jobs/"+e+"/input",n.data=t,o.ajaxWrapper.postJson(n).done(function(e,t,n){if(e=o.fixOldBrowser(e),!new q(e).isValid())return p.log("qgApiHelper addJobInput fail broken response",{info:"response: "+JSON.stringify(e)}),void r.reject(i.BROKEN_SERVER_RESPONSE);p.log("qgApiHelper addJobInput done"),r.resolve(e)}).fail(function(e,t,o){p.log("qgApiHelper addJobInput fail connection problem",e.status),r.reject(i.CONNECTION_PROBLEM)}),r},P.prototype.addInputs=function(e,t){d.isUUID4(e),d.isObject(t);var o=this._api,r=$.Deferred(),n=$.extend({},o.baseAjaxOptions);return n.url="/api/jobs/"+e+"/input",n.data=t,o.ajaxWrapper.postJson(n).done(function(e,t,n){e=o.fixOldBrowser(e);var a=e;if(Array.isArray(e)&&(a=e[0]),!new q(a).isValid())return p.log("qgApiHelper addJobInput fail broken response",{info:"response: "+JSON.stringify(e)}),void r.reject(i.BROKEN_SERVER_RESPONSE);p.log("qgApiHelper addJobInput done"),r.resolve(e)}).fail(function(e,t,o){p.log("qgApiHelper addJobInput fail connection problem",e.status),r.reject(i.CONNECTION_PROBLEM)}),r},P.prototype.addConversion=function(e,t){d.isUUID4(e),d.isObject(t);var o=this._api,r=$.Deferred(),n=$.extend({},o.baseAjaxOptions);return n.url="/api/jobs/"+e+"/conversions",n.data=t,o.ajaxWrapper.postJson(n).done(function(e,t,i){e=o.fixOldBrowser(e),p.log("qgApiHelper addConversion done"),r.resolve(e)}).fail(function(e,t,o){p.log("qgApiHelper addConversion fail connection problem",e.status),402===e.status&&(window.allowLeave=!0,window.location=sat.pricing+"?limit=2"),r.reject(i.CONNECTION_PROBLEM)}),r},P.prototype.startJob=function(e,t){d.isUUID4(e);var o=this._api;void 0===t&&(t=""),d.isString(t);var r=$.Deferred(),n=$.extend({},o.baseAjaxOptions);return n.url="/api/jobs/"+e+"/start",n.data=t,o.ajaxWrapper.post(n).done(function(e,t,i){e=o.fixOldBrowser(e),p.log("qgApiHelper startJob done"),r.resolve(e)}).fail(function(e,t,o){p.log("qgApiHelper startJob fail connection problem",e.status),r.reject(i.CONNECTION_PROBLEM)}),r},P.prototype.deleteInput=function(e,t){d.isUUID4(e),d.isUUID4(t);var o=this._api,r=$.Deferred(),n=$.extend({},o.baseAjaxOptions);return n.url="/api/jobs/"+e+"/input/"+t+"/delete",n.data=$.extend({},o.baseData),o.ajaxWrapper.postJson(n).done(function(e,t,i){e=o.fixOldBrowser(e),p.log("qgApiHelper deleteInput done"),r.resolve(e)}).fail(function(e,t,o){p.log("qgApiHelper deleteInput fail connection problem",e.status),r.reject(i.CONNECTION_PROBLEM)}),r},P.prototype.setPassword=function(e,t,o){d.isUUID4(e),d.isUUID4(t);var r=$.Deferred(),n=this._api,a=$.extend({},n.baseData,{credentials:{decrypt_password:o}}),s=$.extend({},n.baseAjaxOptions);return s.url="/api/jobs/"+e+"/input/"+t+"/patch",s.data=a,n.ajaxWrapper.postJson(s).done(function(e,t,o){e=n.fixOldBrowser(e),p.log("qgApiHelper set password done"),r.resolve(e)}).fail(function(e,t,o){p.log("qgApiHelper set password fail connection problem",e.status),r.reject(i.CONNECTION_PROBLEM)}),r};var T=function(e){return e.hasOwnProperty("code")&&e.hasOwnProperty("text")},R=function(e,t){d.isObject(t),this.api=e,this.baseUrlApi="",d.objectHasKey(t,"baseUrlApi"),this.baseUrlApi=t.baseUrlApi};R.prototype.createJob=function(e){var t=this.api;l.isObject(e)||(e={});var o=$.extend({},t.baseAjaxOptions);o.url=this.baseUrlApi+"/api/jobs",o.data=$.extend({},t.baseData,e);var r=Date.now(),n=$.Deferred();return t.ajaxWrapper.post(o).done(function(e,a,s){if(e=t.fixOldBrowser(e),T(e)){var l="qgApiHelper createJob fail error code",d=i.UNKNOWN;return 1===e.code&&(l="qgApiHelper createJob fail overuse",d=i.OVERUSE),p.log(l,{info:"data: "+JSON.stringify(o.data)+" | response: "+JSON.stringify(e)}),void n.reject(d)}var u=new m(e);if(!u.isValid())return p.log("qgApiHelper createJob fail broken response",{info:"response: "+JSON.stringify(e)}),void n.reject(i.BROKEN_SERVER_RESPONSE);var c=u.getId();t.jobCache.setData(c,e),p.addLogData("job_id",c);var f=(Date.now()-r)/1e3;p.log("qgApiHelper createJob done",{duration_s:f}),n.resolve(e)}).fail(function(e,t,o){p.log("qgApiHelper createJob fail connection problem",e.status),n.reject(i.CONNECTION_PROBLEM)}),n},R.prototype.getJobInfo=function(e){d.isUUID4(e);var t=this.api,o=$.extend({},t.baseAjaxOptions);o.url=this.baseUrlApi+"/api/jobs/"+e,o.data=$.extend({},t.baseData);var r=$.Deferred();return t.numberOfCurrentJobInfoRequests.hasOwnProperty(e)||(t.numberOfCurrentJobInfoRequests[e]=0),t.numberOfCurrentJobInfoRequests[e]++,t.ajaxWrapper.get(o).done(function(n,a,s){return t.numberOfCurrentJobInfoRequests[e]--,n=t.fixOldBrowser(n),T(n)?(p.log("qgApiHelper getJobInfo fail error code",{info:"data: "+JSON.stringify(o.data)+" | response: "+JSON.stringify(n)}),void r.reject(i.UNKNOWN)):new m(n).isValid()?(t.jobCache.setData(e,n),void r.resolve(n)):(p.log("qgApiHelper getJobInfo fail broken response",{info:"response: "+JSON.stringify(n)}),void r.reject(i.BROKEN_SERVER_RESPONSE))}).fail(function(o,n,a){t.numberOfCurrentJobInfoRequests[e]--,p.log("qgApiHelper getJobInfo fail connection problem",o.status),r.reject(i.CONNECTION_PROBLEM)}),r},R.prototype.addInput=function(e,t){d.isUUID4(e),d.isObject(t),d.isNotArray(t),d.objectHasKey(t,"type");var o=this.api;t=$.extend({},o.baseData,t);var r=$.extend({},o.baseAjaxOptions);r.url=this.baseUrlApi+"/api/jobs/"+e+"/input",r.data=t;var n=Date.now(),a=$.Deferred();return o.ajaxWrapper.post(r).done(function(e,t,s){if(e=o.fixOldBrowser(e),T(e)){var l="qgApiHelper addJobInput fail error code",d=i.UNKNOWN;return 50!==e.code&&34!==e.code||(l="qgApiHelper addJobInput fail file too large",d=i.LIMITS_INPUT_TOO_LARGE),p.log(l,{info:"data: "+JSON.stringify(r.data)+" | response: "+JSON.stringify(e)}),void a.reject(d)}if(!new q(e).isValid())return p.log("qgApiHelper addJobInput fail broken response",{info:"response: "+JSON.stringify(e)}),void a.reject(i.BROKEN_SERVER_RESPONSE);var u=(Date.now()-n)/1e3;p.log("qgApiHelper addJobInput done",{duration_s:u}),a.resolve(e)}).fail(function(e,t,o){p.log("qgApiHelper addJobInput fail connection problem",e.status),a.reject(i.CONNECTION_PROBLEM)}),a},R.prototype.addConversion=function(e,t){d.isUUID4(e),d.isObject(t);var o=this.api,r=$.extend({},o.baseAjaxOptions);r.url=this.baseUrlApi+"/api/jobs/"+e+"/conversions",r.data=t;var n=$.Deferred();return o.ajaxWrapper.post(r).done(function(e,t,a){if(e=o.fixOldBrowser(e),T(e))return p.log("qgApiHelper addConversion fail error code",{info:"data: "+JSON.stringify(r.data)+" | response: "+JSON.stringify(e)}),void n.reject(i.UNKNOWN);p.log("qgApiHelper addConversion done"),n.resolve(e)}).fail(function(e,t,o){p.log("qgApiHelper addConversion fail connection problem",e.status),n.reject(i.CONNECTION_PROBLEM)}),n},R.prototype.startJob=function(e,t){d.isUUID4(e);var o=this.api;void 0===t&&(t=""),d.isString(t);var r=$.extend({},o.baseAjaxOptions);r.url=this.baseUrlApi+"/api/jobs/"+e+"/start",r.data=t;var n=$.Deferred();return o.ajaxWrapper.post(r).done(function(e,t,a){if(e=o.fixOldBrowser(e),T(e))return p.log("qgApiHelper startJob fail error code",{info:"data: "+JSON.stringify(r.data)+" | response: "+JSON.stringify(e)}),void n.reject(i.UNKNOWN);p.log("qgApiHelper startJob done"),n.resolve(e)}).fail(function(e,t,o){p.log("qgApiHelper startJob fail connection problem",e.status),n.reject(i.CONNECTION_PROBLEM)}),n},R.prototype.savePreset=function(e){var t=this.api,o=$.extend({},t.baseAjaxOptions);o.url=this.baseUrlApi+"/api/presets",o.data=e,o.maxRetries=2;var r=$.Deferred();return t.ajaxWrapper.post(o).done(function(e,n,a){if(e=t.fixOldBrowser(e),T(e))return p.log("qgApiHelper savePreset fail error code",{info:"data: "+JSON.stringify(o.data)+" | response: "+JSON.stringify(e)}),void r.reject(i.UNKNOWN);p.log("qgApiHelper savePreset done"),r.resolve(e)}).fail(function(e,t,o){p.log("qgApiHelper savePreset fail connection problem",e.status),r.reject(i.CONNECTION_PROBLEM)}),r},R.prototype.deleteInput=function(e,t){d.isUUID4(e),d.isUUID4(t);var o=this.api,r=$.extend({},o.baseAjaxOptions);r.url=this.baseUrlApi+"/api/jobs/"+e+"/input/"+t+"/delete",r.data=$.extend({},o.baseData);var n=$.Deferred();return o.ajaxWrapper.post(r).done(function(e,t,a){if(e=o.fixOldBrowser(e),T(e))return p.log("qgApiHelper deleteInput fail error code",{info:"data: "+JSON.stringify(r.data)+" | response: "+JSON.stringify(e)}),void n.reject(i.UNKNOWN);p.log("qgApiHelper deleteInput done"),n.resolve(e)}).fail(function(e,t,o){p.log("qgApiHelper deleteInput fail connection problem",e.status),n.reject(i.CONNECTION_PROBLEM)}),n},R.prototype.setPassword=function(e,t,o){d.isUUID4(e),d.isUUID4(t),d.isString(o);var r=this.api,n=$.extend({},r.baseAjaxOptions);n.url=this.baseUrlApi+"/api/jobs/"+e+"/input/"+t+"/patch",n.data={decrypt_password:o};var a=$.Deferred();return r.ajaxWrapper.post(n).done(function(e,t,o){if(e=r.fixOldBrowser(e),T(e))return p.log("qgApiHelper set password - fail error code",{info:"data: "+JSON.stringify(n.data)+" | response: "+JSON.stringify(e)}),void a.reject(i.UNKNOWN);p.log("qgApiHelper set password - done"),a.resolve(e)}).fail(function(e,t,o){p.log("qgApiHelper set password - fail connection problem",e.status),a.reject(i.CONNECTION_PROBLEM)}),a};var k=function(e){this._logger=p,void 0!==e&&l.objectHasKey(e,"logger")&&(d.objectHasKey(e.logger,"log"),this._logger=e.logger)},H=function(e){d.isNumber(e),e<1&&(e=1);var t=e;return t>20&&(t=20),t},J=function(e){return d.isNumber(e),e<1&&(e=1),e<3?10:20};k.prototype.ajax=function(e,t){d.isObject(e);var o=0;void 0!==t&&(d.isNumber(t),o=t),e.hasOwnProperty("maxRetries")&&(d.isNumber(e.maxRetries),o=e.maxRetries),e.hasOwnProperty("timeout")?d.isNumber(e.timeout):e.timeout=59e3;var r=!1,i=!0;e.hasOwnProperty("retry400")&&(d.isBoolean(e.retry400),r=e.retry400),e.hasOwnProperty("retry500")&&(d.isBoolean(e.retry500),i=e.retry500);var n=0,a=$.Deferred(),s=this._logger,l=function(e){var t=Date.now();$.ajax(e).done(function(o,r,i){var n=(Date.now()-t)/1e3;n>15&&s.log("qgAjaxWrapper info - long running ajax call","url: "+e.url+" duration: "+n+"s"),a.resolve(o,r,i)}).fail(function(t,d,u){if("timeout"===d&&s.log("qgAjaxWrapper fail - timeout",{info:e.url,ajax_status:d,ajax_error:u,http_status:t.status}),t.status>=400&&t.status<500&&!r)return s.log("qgAjaxWrapper fail - client error",{info:e.url,ajax_status:d,ajax_error:u,http_status:t.status}),void a.reject(t,d,u);var p=t.status>=500&&t.status<600;if(p&&!i)return s.log("qgAjaxWrapper fail - server error",{info:e.url,ajax_status:d,ajax_error:u,http_status:t.status}),void a.reject(t,d,u);if(0===o)return s.log("qgAjaxWrapper fail - no retries",{info:e.url,ajax_status:d,ajax_error:u,http_status:t.status}),void a.reject(t,d,u);if(n>=o)return s.log("qgAjaxWrapper fail - even with retries",{info:e.url,ajax_status:d,ajax_error:u,http_status:t.status}),void a.reject(t,d,u);n+=1;var c=H(n);p&&(c=J(n)),setTimeout(function(){l(e)},1e3*c)})};return l(e),a},k.prototype.post=function(e,t){return e.type="POST",this.ajax(e,t)},k.prototype.postJson=function(e){return e.type="POST",e.contentType="application/json",e.processData=!1,"object"==typeof e.data&&(e.data=JSON.stringify(e.data)),this.ajax(e)},k.prototype.get=function(e,t){return e.type="GET",this.ajax(e,t)};var M=function(e){d.isNumber(e),this.maxCacheTimeSeconds=e,this.data={}};M.prototype.setData=function(e,t){d.isNonEmptyString(e),d.isNotNull(t),d.isNotBoolean(t),this.data[e]={time_ms:Date.now(),data:t}},M.prototype.getData=function(e){return d.isNonEmptyString(e),this.data.hasOwnProperty(e)?!((Date.now()-this.data[e].time_ms)/1e3>this.maxCacheTimeSeconds)&&this.data[e].data:null},M.prototype.getDataEvenIfTooOld=function(e){return d.isNonEmptyString(e),this.data.hasOwnProperty(e)?this.data[e].data:null};var L=function(e,t){d.isNonEmptyString(e),this.apiHelper=null,"oc"===e?this.apiHelper=new R(this,t):"sat"===e&&(this.apiHelper=new P(this,t)),d.isNotNull(this.apiHelper),this.ajaxWrapper=new k,this.jobCache=new M(2),this.numberOfCurrentJobInfoRequests={},this.baseData={},t.hasOwnProperty("baseApiData")&&(this.baseData=t.baseApiData),this.baseAjaxOptions={dataType:"json",crossDomain:!0,xhrFields:{withCredentials:!0},maxRetries:5}};L.prototype.createJob=function(e){var t=this.apiHelper;try{return t.createJob(e)}catch(r){}var o=$.Deferred();return o.reject(i.EXCEPTION),o},L.prototype.createJobWithUploadServerCheck=function(e,t){l.isNumber(t)||(t=1);var o=$.Deferred(),r=this,i=0,n=function(){r.apiHelper.createJob(e).done(function(e){a(e)}).fail(function(e){d.isUploaderError(e),o.reject(e)})},a=function(e){r.checkUploadServer(e.server).done(function(){o.resolve(e,!0)}).fail(function(){if(i>=t){p.log("qgApiHelper createJob info","no upload server found");return void o.resolve(e,!1)}i++;var r=1e3*i;r>1e4&&(r=1e4),setTimeout(function(){n()},r)})};return n(),o},L.prototype.checkUploadServer=function(e,t){d.isNonEmptyString(e),l.isNumber(t)||(t=0);var o=e.replace(/(\/dl.*)/,"/dl/alive"),r={url:o,timeout:1e4,maxRetries:t},n=Date.now(),a=$.Deferred();return this.ajaxWrapper.get(r).done(function(e,t,o){a.resolve()}).fail(function(t,o,r){var s=e.match(/(www[^.]*)/)[0],l=(Date.now()-n)/1e3;p.log("qgApiHelper checkUploadServer fail upload server not available",{upload_server:s,http_status:t.status,ajax_status:o,ajax_error:r,duration_s:l}),a.reject(i.CONNECTION_PROBLEM)}),a},L.prototype.getJobInfo=function(e){d.isUUID4(e);var t=this.apiHelper;try{return t.getJobInfo(e)}catch(r){}var o=$.Deferred();return o.reject(i.EXCEPTION),o},L.prototype.getCachedJobInfo=function(e){d.isUUID4(e);var t=this.jobCache.getData(e);d.isNotNull(t),this.numberOfCurrentJobInfoRequests.hasOwnProperty(e)||(this.numberOfCurrentJobInfoRequests[e]=0);var o=this.numberOfCurrentJobInfoRequests[e]>0;if(!1===t&&!o)return this.getJobInfo(e);var r=this.jobCache.getDataEvenIfTooOld(e),i=$.Deferred();return i.resolve(r),i},L.prototype.addInput=function(e,t){d.isUUID4(e),d.isObject(t);var o=this.apiHelper;try{return o.addInput(e,t)}catch(n){}var r=$.Deferred();return r.reject(i.EXCEPTION),r},L.prototype.addInputs=function(e,t){d.isUUID4(e);var o=this.apiHelper;try{return o.addInputs(e,t)}catch(n){}var r=$.Deferred();return r.reject(i.EXCEPTION),r},L.prototype.addInputId=function(e,t){d.isUUID4(e),d.isUUID4(t);var o={type:"input_id",source:t};return this.addInput(e,o)},L.prototype.addExternalUrl=function(e,t){d.isUUID4(e),d.isNonEmptyString(t);var o={type:"remote",source:t};return this.addInput(e,o)},L.prototype.addConversion=function(e,t){d.isUUID4(e);var o=this.apiHelper;try{return o.addConversion(e,t)}catch(n){}var r=$.Deferred();return r.reject(i.EXCEPTION),r},L.prototype.startJob=function(e,t){d.isUUID4(e);var o=this.apiHelper;try{return o.startJob(e,t)}catch(n){}var r=$.Deferred();return r.reject(i.EXCEPTION),r},L.prototype.deleteInput=function(e,t){d.isUUID4(e),d.isUUID4(t);var o=this.apiHelper;try{return o.deleteInput(e,t)}catch(n){}var r=$.Deferred();return r.reject(i.EXCEPTION),r},L.prototype.setPassword=function(e,t,o){d.isUUID4(e),d.isUUID4(t),d.isString(o);var r=this.apiHelper;try{return r.setPassword(e,t,o)}catch(a){}var n=$.Deferred();return n.reject(i.EXCEPTION),n},L.prototype.fixOldBrowser=function(e){if("string"!=typeof e)return e;try{var t=JSON.parse(e);if("object"==typeof t&&null!==t)return p.log("qgApiHelper server response was fixed",JSON.stringify(e)),t}catch(o){}return p.log("qgApiHelper server response was not fixed",JSON.stringify(e)),e},L.prototype.waitForRemoteInput=function(e,t){d.isUUID4(e),d.isUUID4(t);var o=this,n=$.Deferred(),a=Date.now(),s=function(){var e=(Date.now()-a)/1e3,t=5e3;e<10?t=1e3:e<30?t=2e3:e<60&&(t=3e3),setTimeout(c,t)},l=function(e,o,r){p.log("qgApiHelper waitForRemoteInput fail",{info:JSON.stringify(e),input_id:t,job_info:JSON.stringify(o),duration_s:r});var n=i.UNKNOWN;return 50===e.code||34===e.code?n=i.LIMITS_INPUT_TOO_LARGE:10===e.code&&(n=i.LIMITS_YOUTUBE_FORBIDDEN),n},u=function(e){var o=(Date.now()-a)/1e3,i=new m(e),d=i.getInput(t);if(null===d)return p.log("qgApiHelper waitForRemoteInput info",{info:"input id missing from job",input_id:t,job_info:JSON.stringify(e),duration_s:o}),void s();var u=null,c=i.getInputError(t),f=i.getInputWarning(t),g={code:0,message:"server response is missing fields"};return null!==c?u=l(c,e,o):null!==f?u=l(f,e,o):d.status===r.FAILED&&(u=l(g,e,o)),null!==u?void n.reject(u):i.isInputFinished(t)?(n.resolve(d),void p.log("qgApiHelper waitForRemoteInput done",{input_id:t,duration_s:o})):void s()},c=function(){o.getCachedJobInfo(e).done(function(e){d.isRawJobInfo(e),u(e)}).fail(function(e){d.isUploaderError(e),p.log("qgApiHelper waitForRemoteInput retry",{info:"error: "+e,input_id:t}),s()})};return c(),n},L.prototype.savePreset=function(e){var t=this.apiHelper;try{return t.savePreset(e)}catch(r){}var o=$.Deferred();return o.reject(i.EXCEPTION),o};var z=function(e){return d.isObject(e),new L("oc",e)},B=function(){try{if("XMLHttpRequest"in window&&"withCredentials"in new XMLHttpRequest)return!0}catch(e){}return p.log("qgCapabilities - noCors"),!1},G=function(){try{if("string"==typeof $("#target").val())return!0}catch(e){}return p.log("qgCapabilities - noTarget"),!1},V=function(){try{if(!0==!!(window.File&&window.FileReader&&window.FileList&&window.Blob))return!0}catch(e){}return p.log("qgCapabilities - noFileAPI"),!1},X=function(){try{return!!new Blob}catch(e){}return p.log("qgCapabilities - noBlob"),!1},W=function(){return B&&X()&&V()},K={supportsCors:B,supportsTarget:G,supportsFileApi:V,supportsBlob:X,isModernBrowser:W};window.qgMultiFileUploaderLib={inputEvents:e,uploaderErrors:i,capabilities:K,createNewUploader:function(e){var t=z(e);return new j(t,e)},createNewUi:function(e,t){return new f(e,t)}}}();var qgValidate=function(){var e={},t={},o=function(e){t.capCors=e,l()},r=function(e,t){switch(e){case"image":$("#width").rules("add",{digits:!0,range:[1,65e3],messages:{digits:qgValidate.qgMessages.digits,range:qgValidate.qgMessages.image_width.range}}),$("#height").rules("add",{digits:!0,range:[1,65e3],messages:{digits:qgValidate.qgMessages.digits,range:qgValidate.qgMessages.image_height.range}});break;case"video":$("#width").rules("add",{digits:!0,range:[1,1e4],messages:{digits:qgValidate.qgMessages.digits,range:qgValidate.qgMessages.video_width.range}}),$("#height").rules("add",{digits:!0,range:[1,1e4],messages:{digits:qgValidate.qgMessages.digits,range:qgValidate.qgMessages.video_height.range}})}},i=function(){return!!$("#external_url").val()},n=function(){return!!$("#file").val()},a=function(){return!!document.getElementById("gdrive_input")},s=function(){return!!document.getElementById("hash_string")&&$("#hash_string").val().length>0},l=function(){$.validator.addMethod("allowExactlyOneUploadSource",function(e,o){if(!1===t.capCors)return!0;var r=i()+n()+a()+s();return r>1?this.optional(o)||!1:0!==r},function(e,t){return 0===i()+n()+a()+s()?qgValidate.qgMessages.noInputDefinedByUser:qgValidate.qgMessages.moreThanOneInputDefinedByUser}),$.validator.addMethod("custom_url",function(e,t){return this.optional(t)||e.length>=4&&e.length<=4e3},"Please provide a valid URL."),jQuery.validator.addMethod("filename_length",function(e,t){return this.optional(t)||$("#file").val().length<=130},"Filename Too Long"),jQuery.validator.addMethod("filesize",function(e,t,o){return this.optional(t)||t.files[0].size<=o}),jQuery.validator.addMethod("filesizeZero",function(e,t){return this.optional(t)||t.files[0].size>0},"The file does not contain any data and therefore can't be converted"),jQuery.validator.addMethod("timestamp",function(e,t){return this.optional(t)||/^[0-9]{2}:[0-9]{2}:[0-9]{2}$/.test(e)},e.timestamp),jQuery.validator.addMethod("video_bitrate",function(e,t){return 0==$("#video_target_size").length||(this.optional(t)||!($("#video_target_size").val().length>0&&$("#video_quality").val().length>0))},e.bitrateFilesize)};return{init:o,initAdditionalRules:r,qgRules:{file:{allowExactlyOneUploadSource:!0,filename_length:!0},external_url:{allowExactlyOneUploadSource:!0,normalizer:function(e){return $.trim(e)},custom_url:!0,maxlength:2500},hash_string:{allowExactlyOneUploadSource:!0,maxlength:4096},dpi:{digits:!0,range:[10,1200]},border:{number:!0,range:[0,20]},video_bitrate:{video_bitrate:!0,number:!0,range:[5,1e5]},file_size:{video_bitrate:!0,number:!0,range:[.005,2e3]},framerate:{number:!0,range:[1,120]},start:{timestamp:!0},end:{timestamp:!0},crop_top:{number:!0,range:[0,1e5]},crop_bottom:{number:!0,range:[0,1e5]},crop_left:{number:!0,range:[0,1e5]},crop_right:{number:!0,range:[0,1e5]},base_font_size:{number:!0,range:[6,22]},black_white_threshold:{number:!0,range:[0,100]},speckles_threshold:{number:!0,range:[8,1e7]}},qgMessages:e}}(),qgMultiFileUploader=function(){var e=function(e,t){try{window.qgLogger.log(e,t)}catch(o){}},t=null,o=null,r=function(){var e={},o=!1,r=function(){a();$(".cancel_upload").addClass("hidden");var o=$("#forms").serialize();o+="&conversion_id="+t.getJob().getConversionId(),function(e){var o=$.Deferred();return 0===$.trim($("#save-settings-name").val()).length?(o.resolve(),o):(t.savePreset(e).done(function(e){o.resolve()}).fail(function(){o.resolve()}),o)}(o).then(function(){return t.startJob(o)}).done(function(){window.location.href=e.resultBase+t.getJob().getId()}).fail(function(){u()})},i=function(){$(".submit-button-text-start-conversion").removeClass("hidden"),$(".submit-button-text-uploading, .submit-button-text-submitting").addClass("hidden"),$(".cancel_upload").addClass("hidden")},n=function(){$(".submit-button-text-start-conversion, .submit-button-text-submitting").addClass("hidden"),$(".submit-button-text-uploading").removeClass("hidden"),$(".cancel_upload").removeClass("hidden")},a=function(){$(".submit-button-text-start-conversion, .submit-button-text-uploading").addClass("hidden"),$(".submit-button-text-submitting").removeClass("hidden"),$(".cancel_upload").addClass("hidden")},s=function(){$(".multifile-submit-button").prop("disabled",!1)},l=function(){$(".multifile-submit-button").prop("disabled",!0)},d=function(){o=!0,$("#externalUrlInput").val(""),$("#externalUrlField").hide(),(t.getNumberOfQueuedInputs()>0||t.getNumberOfActiveFileUploads()>0)&&n(),l(),t.disable(),p()},u=function(){o=!1,i(),s(),t.enable()},p=function(){if(o)return 0===t.getNumberOfQueuedInputs()&&0===t.getNumberOfInputsInApi()?void u():t.getNumberOfActiveFileUploads()>0||t.getNumberOfQueuedInputs()>0||t.getNumberOfDeletingInputs()>0?void(o&&setTimeout(p,500)):void r()},c=function(){if(!o){if(!e.formValidator.form())return void u();var r=$.trim($("#externalUrlInput").val());if(0===t.getNumberOfQueuedInputs()&&0===t.getNumberOfInputsInApi()&&r.length>0&&t.addExternalUrl(r),0===t.getNumberOfQueuedInputs()&&0===t.getNumberOfInputsInApi())return u(),void qgAlertHelper.show(qgAlertHelper.alerts.INPUT_MISSING);d()}},f=function(e,t,o){e===qgMultiFileUploaderLib.inputEvents.INPUT_FAIL&&u()};return{submit:c,init:function(t){e=t,$(".cancel_upload").click(function(e){e.preventDefault(),e.stopPropagation(),u()})},callback:f}}(),i=function(e){!function(){$("#dropboxButton").click(function(e){e.preventDefault(),e.stopPropagation(),t.isEnabled()&&t.addDropbox()})}(),function(){$("#externalUrlButton").click(function(e){e.preventDefault(),e.stopPropagation(),t.isEnabled()&&$("#externalUrlField").toggle("fast",function(){$("#externalUrlField").is(":visible")&&$("#externalUrlInput").focus()})}),$(".addExampleFile").removeClass("hidden"),$(".addExampleFile").click(function(){if(t.isEnabled()){var e=$.trim($("#externalUrlExample").val());0===e.length&&(e="https://static.online-convert.com/example-file/raster%20image/jpeg/example.jpeg"),t.addExternalUrl(e)}}),$("#externalUrlField .addUrlButton").click(function(){if(t.isEnabled()){var e=$.trim($("#externalUrlInput").val());0!==e.length&&(t.addExternalUrl(e),$("#externalUrlInput").val(""))}}),$("#externalUrlField .cancelButton").click(function(){$("#externalUrlInput").val(""),$("#externalUrlField").hide()}),$("#externalUrlField #externalUrlInput").keydown(function(e){13==e.keyCode&&$("#externalUrlField .addUrlButton").trigger("click")})}(),function(){$(".dropzone").click(function(e){e.preventDefault(),e.stopPropagation(),t.isEnabled()&&$("#fileUploadInput").click()})}(),function(){$("#gdriveButton").click(function(e){e.preventDefault(),e.stopPropagation(),t.isEnabled()&&t.addGdrive()})}(),function(){$(".multifile-submit-button").click(function(e){e.preventDefault(),e.stopPropagation(),r.submit()})}(),$("#forms").attr("action","")},n=function(){var o=!1,r=!1,i="",n=0,a=!1,s=null,l=null,d=function(){u(),l.removeClass("hidden")},u=function(){$("#upload-overlay").removeClass("hidden"),$("#blurred-layer").addClass("overlay-blur"),$(".blurred-shadow").removeClass("hidden")},p=function(){g(),c(),f(),o=!1},c=function(){s.addClass("hidden"),s.find(".panel-warning").addClass("hidden"),s.find(".panel-subheading").addClass("hidden")},f=function(){l.addClass("hidden")},g=function(){$("#upload-overlay").addClass("hidden"),$("#blurred-layer").removeClass("overlay-blur"),$(".blurred-shadow").addClass("hidden")},v=function(r,s,l){if(!o&&r===qgMultiFileUploaderLib.inputEvents.INPUT_FAIL&&l.hasOwnProperty("error")){o=!0,n=0,a=!1;var u=l.error,p=i;if(u===qgMultiFileUploaderLib.uploaderErrors.LIMITS_INPUT_TOO_LARGE){e("qgMultiUpload show payment overlay file too large"),l.hasOwnProperty("size")&&(n=l.size),p+="/size";var c=1===t.getNumberOfAllInputs();return n>0&&c&&(p+="?filesize="+n),void(window.location.href=p)}return u===qgMultiFileUploaderLib.uploaderErrors.LIMITS_TOO_MANY_INPUTS?(e("qgMultiUpload show payment overlay too many files"),p+="/inputs",window.location.href=p,void(a=!0)):u===qgMultiFileUploaderLib.uploaderErrors.LIMITS_YOUTUBE_FORBIDDEN?(e("qgMultiUpload show payment overlay youtube forbidden"),void d()):void 0}};return{init:function(e){$(".free-user-btn").click(function(){p()}),$(".panel-dismiss").click(function(){p()}),$(".premium-user-btn").click(function(){var t=e.registerUrl;n>0?t+="/size?filesize="+n:!0===a&&(t+="/inputs"),window.location.href=t}),r=e.isFreeUser,i=e.registerUrl,s=$("#upload-overlay .payment-required"),l=$("#upload-overlay .youtube-forbidden"),p()},callback:v}}(),a=function(e){var t=$("#category").val(),o=e.inputForm,r=$(o).validate({ignoreTitle:!0,onkeyup:!1,onsubmit:!1,rules:qgValidate.qgRules,messages:qgValidate.qgMessages});return qgValidate.init(!0),qgValidate.initAdditionalRules(t,o),r},s=function(){"string"==typeof window.qgInputFromGetInputId&&t.addInputId(window.qgInputFromGetInputId),"string"==typeof window.qgInputFromGetExternalUrl&&t.addExternalUrl(window.qgInputFromGetExternalUrl),"string"==typeof window.qgInputFromGetGDriveToken&&"string"==typeof window.qgInputFromGetGDriveFilename&&"string"==typeof window.qgInputFromGetGDriveFileId&&"string"==typeof window.qgInputFromGetGDriveMimeType&&t.addGdrive(window.qgInputFromGetGDriveFilename,window.qgInputFromGetGDriveToken,window.qgInputFromGetGDriveFileId,window.qgInputFromGetGDriveMimeType)};return{init:function(l){$("#listItemExternalUrl").remove(),$("#multifileUploadBox").show(),$(".multifile-submit-button").removeClass("hidden"),$("input[type='submit']").addClass("hidden");var d={form:function(){return!0},showErrors:function(e){}};try{d=a(l)}catch(c){e("qgMultiUpload setup validation fail","exception message: "+c.message)}var u={maxNumberOfInputs:l.maxInputs,maxFileSize:l.maxFileSize,enableUploadCheck:!0,preventNavigateAway:!0,fileListSelector:"#fileUploadList",fileUploadInputId:"#fileUploadInput",domain:l.feApiBaseUrl,baseUrlApi:l.feApiBaseUrl,registerUrl:l.feRegisterUrl,resultBase:l.resultBase,jobData:l.jobData,uiErrorCallback:$.noop,gdriveClientId:gdrive_clientId,gdriveDeveloperKey:gdrive_developerKey,formValidator:d,target:l.target,category:l.category,isFreeUser:l.isFreeUser,blockYouTubeUrls:!1,failOnConversionError:l.failOnConversionError,enableUploadFallback:l.enableUploadFallback};"audio"!==l.category&&"video"!==l.category||(u.blockYouTubeUrls=!0);var p=$("#csrf_token");p.length>0&&(u.baseApiData={csrf_token:p.val()}),t=qgMultiFileUploaderLib.createNewUploader(u),o=qgMultiFileUploaderLib.createNewUi(t,u),r.init(u),t.registerInputEventCallback(r.callback),n.init(u),t.registerInputEventCallback(n.callback),s(),i()}}}(),qgOldUploader=function(){"use strict";var e=function(e,t){try{if(void 0===t)t={};else if("string"==typeof t)t={info:t};else if("object"!=typeof t)try{t={info:JSON.stringify(t)}}catch(o){}a.length>0&&(t.job_id=JSON.stringify(a)),window.qgLogger.log(e,t)}catch(o){}},t=null,o=null,r=10,i=!1,n=null,a=[],s=null,l=null,d=null,u=null,p=null,c=null,f=null,g=0,v=function(){return{form:function(){return!0},showErrors:function(e){}}},h=v(),m=v(),b=function(e){window.location=u+e},_={initMain:function(t){g=t.maxFileSize,n=t.inputForm,s=t.fileForm,l=t.fileInput,d=t.requestDomain,u=t.resultBase,p=t.overuseUrl,c=t.filetoobigUrl,f=$("#category").val();try{h=$(n).validate({ignoreTitle:!0,onkeyup:!1,onsubmit:!1,rules:qgValidate.qgRules,messages:qgValidate.qgMessages}),m=$(s).validate({ignoreTitle:!0,onkeyup:!1,onsubmit:!1,rules:qgValidate.qgRules,messages:qgValidate.qgMessages})}catch(o){e("qgHandle init - error setting up form validators")}jQuery().fileupload||e("qgHandle init - jquery fileuploader not available"),_.initFileUploader(s),_.isFileUploaderInitialized(s)||e("qgHandle init - jquery fileuploader not initialized"),_.initSubmitButton()},initSubmitButton:function(){qgValidate.init(qgCapabilities.supportsCors()),_.setupValidationEvents(h,m),qgValidate.initAdditionalRules(f,n),$(n).submit(function(e){e.preventDefault();var t=m.form(),o=h.form();t&&o&&I()&&(i||(i=!0,w.createJob()))})},initFileUploader:function(t){try{qgOldUploaderHelper.initFileUploader(t,U,e)}catch(r){var o="no error message in exception";r.hasOwnProperty("message")&&(o=r.message),e("qgHandle qgUpload uploadSingleFile fail on create",{error_message:o})}y.showFileUpload()},isFileUploaderInitialized:function(e){try{$("#forms-input").fileupload("active")}catch(t){return!1}return!0},setupValidationEvents:function(e,t){$("#external_url").change(function(){t.form(),e.form()}),$("#file").change(function(){t.form(),e.form()}),$("#hash_string").change(function(){t.form(),e.form()})}},y={showFileUpload:function(){$(".main-input-form").show(),$("#cloud_convert").show()},showCreateJob:function(){$("#qg-submit").hide(),y.openForms(),$("#cloud_convert").find("a").css("pointer-events","none"),$("#cloud_convert").find("#drive_picker").css("pointer-events","none"),$("#oc-ajax-loader-bar-uploading").hide(),$("#oc-ajax-loader-bar").show()},resetPage:function(){window.unsaved=!1,i=!1,$("#qg-submit").show(),y.openForms(),$("#oc-ajax-loader-bar").hide(),$("#oc-ajax-loader-bar-uploading").hide(),$("#oc-upload-progress").hide(),$(".progress-bar-v2").css("width","0%"),$("#cloud_convert").find("a").css("pointer-events","all"),$("#cloud_convert").find("#drive_picker").css("pointer-events","all")},showProgress:function(){this.closeForms(),$("#oc-ajax-loader-bar").hide(),$("#ajax-loader-bar").hide(),$("#oc-upload-progress").show()},openForms:function(){$(n+" input").not(".isDisabled").prop("disabled",!1),$(s+" input").not(".isDisabled").prop("disabled",!1),$(n+" select").not(".isDisabled").prop("disabled",!1)},destroyFileupload:function(e){$(e).fileupload("disable"),$(e).fileupload("destroy")},showUploading:function(){$("#oc-ajax-loader-bar").hide(),$("#oc-ajax-loader-bar-uploading").show()},closeForms:function(){$(n+" input").prop("disabled",!0),$(s+" input").prop("disabled",!0),$(n+" select").prop("disabled",!0)}},I=function(){if(!qgCapabilities.supportsFileApi())return!0;try{var t=$(l)[0].files[0];return"undefined"==typeof $(l)[0].files[0]||(t.size>g?(e("qgHandle checkConstraints - maxFileSize exceeded",{file_size:t.size,max_file_size:g}),window.unsaved=!1,window.location.assign(c+t.size),!1):0!==t.size||!qgCapabilities.supportsBlob()||(m.showErrors({file:"The file does not contain any data and therefore can't be converted"}),e("qgHandle checkConstraints - filesizeZero"),!1))}catch(r){var o="no info";try{o=r.message}catch(i){}return e("qgHandle checkConstraints - exception",{exception_message:o}),!0}},w={createJob:function(){y.showCreateJob(),qgJob.createJob(d,n).done(function(r,i){if(null==r)return e("qgHandle qgJob createJob fail - empty server response"),alert("Something went wrong, please try again later!"),void y.resetPage();if(r.hasOwnProperty("error"))return void w.handleJobCreateErrorCode(r);if("string"!=typeof r.job_id)return e("qgHandle qgJob createJob fail - broken server response",{response:JSON.stringify(r)}),alert("Something went wrong, please try again later!"),void y.resetPage();if(a.push(r.job_id),e("qgHandle qgJob createJob success"),!0===r.redirect)return e("qgHandle qgUpload UploadSingleFile success with remote input"),void b(r.job_id);if(window.unsaved=!0,t=r.token,o=r.upload_url,$(s).attr("action",o),$("#token").val(t),$("#redirect_to").val(u+r.job_id),$("#redirect_register").val(p),qgCapabilities.supportsBlob())try{y.showProgress(),qgOldUploaderHelper.uploadStart(o,t)}catch(l){y.openForms();try{y.destroyFileupload()}catch(d){}var n="no error message in exception";l.hasOwnProperty("message")&&(n=l.message),O(n)}else O("no blob")}).fail(function(e,t){if(e&&e.hasOwnProperty("error"))return void w.handleJobCreateErrorCode(e);w.retryJob(e,t)})},handleJobCreateErrorCode:function(t){var o="Something went wrong, please try again later!";if(!t.hasOwnProperty("error")||!t.error.hasOwnProperty("code"))return e("qgHandle qgJob createJob fail - broken error response",{response:JSON.stringify(data)}),alert(o),void y.resetPage();var r=t.error.code;return 1===r?(e("qgHandle qgJob createJob fail - overuse"),void(window.location=p)):2===r?(e("qgHandle qgJob createJob fail - invalid option",{response:JSON.stringify(t)}),alert(o),void y.resetPage()):5===r?(e("qgHandle qgJob createJob fail - forbidden Input ID",{response:JSON.stringify(t)}),alert(t.error.text),void y.resetPage()):(e("qgHandle qgJob createJob fail - unhandled error code",{response:JSON.stringify(t)}),alert(o),void y.resetPage())},retryJob:function(t,o){var i="",n="";try{i=JSON.stringify(t)}catch(a){i=JSON.stringify(a)}try{n=JSON.stringify(o)}catch(a){n=JSON.stringify(a)}r>0?(e("qgHandle qgJob createJob fail - retry",{server_response:i,form_info_data:n}),r-=1,window.setTimeout(w.createJob,1e3)):(e("qgHandle qgJob createJob critical fail - retries exhausted",{server_response:i,form_info_data:n}),alert(qgValidate.qgMessages.networkErrorMessage),y.resetPage())}},O=function(t){t||(t="no error message given"),y.openForms(),y.showUploading(),e("qgHandle qgUpload UploadSingleFile success with fallback upload",{error_message:t}),window.unsaved=!1,$(s).unbind("submit").submit(),y.closeForms()},U={createUUID:function(e){try{return e+Math.floor(65536*(1+Math.random())).toString(6)}catch(t){return Math.floor(65536*(1+Math.random())).toString(6)}},updateProgress:function(e){$("#uploadfilesize").html(e.size),$("#uploadrate").html(e.speed),$("#uploadtimeleft").html(e.time),$(".progress-bar-v2").css("width",e.percentage+"%")},uploadDone:function(t,o){window.unsaved=!1,e("qgHandle qgUpload UploadSingleFile success");var r="noInfo";try{r=JSON.stringify(o.slice(-30))}catch(a){}try{if(!0===t.jqXHR.responseJSON.completed)b(t.jqXHR.responseJSON.id.job);else{var i="no json response";try{i=JSON.stringify(t.jqXHR.responseJSON)}catch(s){}e("qgHandle qgUpload UploadSingleFile critical fail - response from server broken",{upload_info:r,json_response:i}),alert(qgValidate.qgMessages.networkErrorMessage),y.resetPage()}}catch(a){try{var n="no info";try{n=a.message}catch(s){}e("qgHandle qgUpload UploadSingleFile critical fail - response from server broken",{upload_info:r,exception_message:n}),alert(qgValidate.qgMessages.networkErrorMessage),y.resetPage()}catch(a){e("qgHandle qgUpload UploadSingleFile critical fail - response from server broken"),alert(qgValidate.qgMessages.networkErrorMessage),y.resetPage()}}},uploadError:function(t,o,r,i){window.unsaved=!1,"undefined"==typeof r.jqXHR.responseJSON?e("qgHandle qgUpload UploadSingleFile error with non-json response"):"undefined"!=typeof r.jqXHR.responseJSON.error_code?(e("qgHandle qgUpload UploadSingleFile error with code",{error_code:r.jqXHR.responseJSON.error_code}),3===r.jqXHR.responseJSON.error_code&&(window.unsaved=!1,window.location.assign(c+r.jqXHR.responseJSON.filesize_mb)),2===r.jqXHR.responseJSON.error_code&&(window.unsaved=!1,e("qgHandle qgUpload UploadSingleFile success with dl trust"),b(a[0])),5===r.jqXHR.responseJSON.error_code&&(e("qgHandle qgUpload UploadSingleFile critical fail - Invalid File"),alert(qgValidate.qgMessages.networkErrorMessage),y.resetPage())):(e("qgHandle qgUpload UploadSingleFile error json response without error_code"),alert(qgValidate.qgMessages.networkErrorMessage),y.resetPage()),e(t,i)}};return{init:function(e){_.initMain(e)},getJobId:function(){return a}}}(),qgOldUploaderHelper=function(){var e={uploadUrl:null,uploadToken:null,uploadUUID:null,uploadForm:null},t=[],o={},r=function(r,s,l){o.handleUpload=s,o.log=l,e.uploadForm=r,$(r).fileupload({url:e.uploadUrl,dataType:"json",maxChunkSize:n.getDynamicChunkSize,singleFileUploads:!0,autoUpload:!1,replaceFileInput:!1,maxRetries:50,dropZone:null,retryTimeout:500,retries:0,beforeSend:function(t,o){t.setRequestHeader("x-oc-token",e.uploadToken),t.setRequestHeader("X-Oc-Upload-Uuid",e.uploadUUID)}}).bind("fileuploadadd",function(t,r){qgOldUploaderHelper.uploadStart=function(t,i){e.uploadUrl=t,e.uploadToken=i,e.uploadUUID=o.handleUpload.createUUID(e.uploadToken),r.submit()}}).bind("fileuploaddone",function(e,r){o.handleUpload.uploadDone(r,t)}).bind("fileuploadfail",function(t,a){if(n.resetChunkSpeed(),a&&"object"==typeof a.jqXHR&&"undefined"!=typeof a.jqXHR.responseJSON)if("Problem uploading file"===a.jqXHR.responseJSON.error)i(a,t);else{try{if("undefined"!=typeof $(r).find("input:file")[0].files[0])var s=$(r).find("input:file")[0].files[0];else var s={name:null,size:null,type:null}}catch(l){var s={name:null,size:null,type:null}}o.handleUpload.uploadError("qgHandle qgUpload singleFileUpload - general error info",t,a,{token:e.uploadToken,server:e.uploadUrl,uuid:e.uploadUUID,file_info:JSON.stringify({name:s.name,size:s.size,type:s.type}),response:JSON.stringify(a.jqXHR.responseJSON)})}else i(a,t)}).bind("fileuploadprogress",function(e,t){o.handleUpload.updateProgress(a.renderData(t))}).bind("fileuploadchunkdone",function(e,t){var o=$(this).data("blueimp-fileupload")||$(this).data("fileupload");n.increaseChunkSpeed(),o.options.retries>10&&(o.options.retries=10)}).bind("fileuploadchunkalways",function(o,r){var i={range:r.contentRange,loaded:r.loaded,uploadedBytes:r.uploadedBytes,textStatus:r.textStatus,url:r.url,uuid:e.uploadUUID};t.push(i)})},i=function(r,i){var n=$(e.uploadForm).data("blueimp-fileupload")||$(e.uploadForm).data("fileupload"),s=function(){r.submit()};"abort"!==r.errorThrown&&r.uploadedBytes<r.files[0].size&&n.options.retries<n.options.maxRetries?(o.handleUpload.uploadError("qgHandle qgUpload singleFileUpload - chunk fail: retry",i,r,{token:e.uploadToken,uuid:e.uploadUUID,server:e.uploadUrl,bitrate:a.formatBitrate(r._bitrateTimer.bitrate),totalLoaded:a.formatFileSize(r._bitrateTimer.loaded),currentRetry:n.options.retries}),n.options.retries+=1,window.setTimeout(s,n.options.retries*n.options.retryTimeout)):(t=t.slice(-30),o.handleUpload.uploadError("qgHandle qgUpload singleFileUpload critical fail - retries exhausted",i,r,{token:e.uploadToken,uuid:e.uploadUUID,server:e.uploadUrl,chunkinfo:JSON.stringify(t)}),alert(qgValidate.qgMessages.networkErrorMessage))},n={baseChunkSize:1e6,minChunkSize:1e5,maxChunkSize:1e8,speedModifier:3,maxSpeedModifier:5,increaseChunkSpeed:function(){n.limitSpeed(++n.speedModifier)},resetChunkSpeed:function(){n.speedModifier=1},getDynamicChunkSize:function(e){var t=e.progress();if(0===t.loaded)return n.baseChunkSize;if(1===n.speedModifier)return n.minChunkSize;var o=parseInt(t.bitrate)*n.speedModifier;return n.limitChunk(o)},limitChunk:function(e){return Math.max(n.minChunkSize,Math.min(e,n.maxChunkSize))},limitSpeed:function(e){n.speedModifier=Math.max(1,Math.min(e,n.maxSpeedModifier))}},a={renderData:function(e){return{speed:this.formatBitrate(e.bitrate),size:this.formatFileSize(e.loaded)+" / "+this.formatFileSize(e.total),time:this.formatTime(8*(e.total-e.loaded)/e.bitrate),percentage:this.formatPercentage(e.loaded/e.total)}},formatBitrate:function(e){return"number"!=typeof e?"":e>=1e9?(e/1e9).toFixed(2)+" Gbit/s":e>=1e6?(e/1e6).toFixed(2)+" Mbit/s":e>=1e3?(e/1e3).toFixed(2)+" kbit/s":e.toFixed(2)+" bit/s"},formatFileSize:function(e){return"number"!=typeof e?"":e>=1e9?(e/1e9).toFixed(2)+" GB":e>=1e6?(e/1e6).toFixed(2)+" MB":(e/1e3).toFixed(2)+" KB"},formatTime:function(e){var t=new Date(1e3*e),o=Math.floor(e/86400);return(o=o?o+"d ":"")+("0"+t.getUTCHours()).slice(-2)+":"+("0"+t.getUTCMinutes()).slice(-2)+":"+("0"+t.getUTCSeconds()).slice(-2)},formatPercentage:function(e){return(100*e).toFixed(0)}};return{initFileUploader:r}}(),qgVeryOldUploader=function(){return{init:function(e){$(e.inputForm).submit(function(t){t.preventDefault(),$(e.inputForm).unbind("submit").submit()})}}}(),qgJob=function(){"use strict";var e=function(e,t){try{window.qgLogger.log(e,t)}catch(o){}},t=function(t){var o=$.Deferred(),r=t.replace(/(\/dl.*)/,"/dl/alive");return $.ajax({type:"GET",url:r,timeout:15e3}).done(function(e,t,r){o.resolve()}).fail(function(r,i,n){var a=t.match(/(www[^.]*)/)[0],s={upload_server:a,ajax_text_status:i,ajax_error_thrown:n,http_status:r.status};e("qgHandle qgJob createJob upload server not available",s),o.reject()}),o};return{createJob:function(o,r){var i=$.Deferred(),n=$(r).serialize(),a=0,s=function(){$.ajax({type:"POST",url:o,data:n,cache:!1,xhrFields:{withCredentials:!0}}).done(function(o){if("string"==typeof o)try{o=JSON.parse(o)}catch(r){return e("qgHandle qgJob createJob error while json-parsing server response",{response:o}),void i.resolve(o,n)}return o.hasOwnProperty("job_id")&&o.hasOwnProperty("upload_url")?"string"==typeof o.upload_url&&o.upload_url?void t(o.upload_url).done(function(){i.resolve(o,n)}).fail(function(){if(a<5){a++;var e=1e3*Math.pow(a/2,2);setTimeout(function(){s()},e)}else i.reject("reached max dl server check",n)}):(e("qgHandle qgJob createJob problem with upload_url",{response:JSON.stringify(o)}),void i.resolve(o,n)):void i.resolve(o,n)}).fail(function(e,t){i.reject(t,n)})};return s(),i}}}(),qgFileoptions=function(){return{getOptions:function(e,t,o){var r=$.Deferred(),i={source_format:t};return void 0!==o&&(i.mime_type=o),$.ajax({type:"POST",url:e,data:i,cache:!1,xhrFields:{withCredentials:!0}}).success(function(e){try{r.resolve(JSON.parse(e))}catch(t){r.resolve(e)}}).fail(function(e,t){r.reject(t,e)}),r}}}(),qgHandle=function(){"use strict";var e=function(e,t){try{if(void 0===t)t={};else if("string"==typeof t)t={info:t};else if("object"!=typeof t)try{t={info:JSON.stringify(t)}}catch(r){}try{var o=qgOldUploader.getJobId();o.length>0&&(t.job_id=JSON.stringify(o))}catch(r){}window.qgLogger.log(e,t)}catch(r){}},t={inputForm:null,fileForm:null,fileInput:null,requestDomain:null,resultBase:null,overuseUrl:null,filetoobigUrl:null,category:null,jobId:[],jobData:null,qgJobData:null,maxFileSize:0,feApiBaseUrl:null,failOnConversionError:null},o=function(e){t.inputForm=e.inputForm,t.fileForm=e.fileForm,t.fileInput=e.fileInput,t.requestDomain=e.requestDomain,t.resultBase=e.resultBase,t.overuseUrl=e.overuseUrl,t.filetoobigUrl=e.filetoobigUrl,t.maxFileSize=e.max_file_size,t.maxInputs=e.max_inputs,t.jobData=e.jobData,t.feApiBaseUrl=e.base_url,t.feRegisterUrl=e.register_url,t.target=e.target,t.category=e.category,t.isFreeUser=e.isFreeUser,t.failOnConversionError=e.failOnConversionError,t.enableUploadFallback=e.enableUploadFallback,$(".jsenabled").show(),$("#presetPage").length&&n.init(),!$("#presetPage").length&&$("#globalPresetDropdown").length&&i.init(),r.init(),a.checkIfAudioVbrPage(),a.setCategory(),a.beforeUnload();var o=$("#multifileUploadBox").length>0,s=qgMultiFileUploaderLib.capabilities;o&&s.isModernBrowser()&&s.supportsTarget()?qgMultiFileUploader.init(t):s.supportsCors()&&s.supportsTarget()?(window.qgCapabilities=qgMultiFileUploaderLib.capabilities,qgOldUploader.init(t)):(window.qgCapabilities=qgMultiFileUploaderLib.capabilities,qgVeryOldUploader.init(t))},r={init:function(){$(".optional_settings").length&&$("#save-settings-list-entry").show(),$("#userPresetDropdown").length&&($("#saved-settings-container").show(),$("#userPresetDropdown").prop("disabled",!1),$("#save-settings-name").prop("disabled",!1),$("#userPresetDropdown").change(function(){if(!user_preset_options_json.hasOwnProperty(this.value))return void r.clearAllValues(!0);r.clearAllValues(!1),r.setSavedOptionsValues(user_preset_options_json[this.value])}),r.resetSelectedUserPresetOnOptionsChange())},clearAllValues:function(e){$(".optional_settings :input").each(function(){if($(this).is("select")){if(!e&&"user_preset"===this.name)return;$(this)[0].selectedIndex=0}else $(this).is(":checkbox")?$(this).prop("checked",!1):$(this).is(":radio")?$('[name="'+this.name+'"]:first').prop("checked",!0):$(this).val("")}),$("#bitrate").show()},setSavedOptionsValues:function(e){$.each(e,function(e,t){var o="[name='"+e+"']";$(o).is("select")?($(o).find('option[value="'+t+'"]').prop("selected",!0),"audio_vbr"===e&&""!==t&&$("#bitrate").hide(),"audio_bitrate"===e&&""!==t&&$("#bitrate").show()):$(o).is(":checkbox")||"checkbox"===$(o).attr("type")?("1"===t||"alpha_channel"===e&&"auto_create"===t)&&$(o).prop("checked",t):$(o).is(":radio")?$(o+"[value='"+t+"']").prop("checked",!0):$(o).val(t),"target"===e&&$("#presetPage").length&&n.updatePresetOptions(t)})},resetSelectedUserPresetOnOptionsChange:function(){$(".optional_settings :input").change(function(){"user_preset"!==this.name&&0!==$("#userPresetDropdown")[0].selectedIndex&&($("#userPresetDropdown")[0].selectedIndex=0)})}},i={init:function(){$("#presetPage").length||$("#globalPresetDropdown").length&&($("#globalPresetDropdown").find("option").not(":first").remove(),i.showJsPresets(),$("#globalPresetDropdown").change(function(){""!==this.value?i.disableOptionsForPresetConversion():i.enableBlockedPresetOptions()}))},disableOptionsForPresetConversion:function(){$("#width").val(""),$("#width").prop("disabled",!0),$("#width").addClass("isDisabled"),$("#height").val(""),$("#height").prop("disabled",!0),$("#height").addClass("isDisabled"),$("#rate").val(""),$("#rate").prop("disabled",!0),$("#rate").addClass("isDisabled"),$("#video_codec").append('<option value="">from preset</option>'),$("#video_codec").val(""),$("#video_codec").prop("disabled",!0),$("#video_codec").addClass("isDisabled"),$("#audio_codec").append('<option value="">from preset</option>'),$("#audio_codec").val(""),$("#audio_codec").prop("disabled",!0),$("#audio_codec").addClass("isDisabled")},enableBlockedPresetOptions:function(){$("#width").prop("disabled",!1),$("#width").removeClass("isDisabled"),$("#height").prop("disabled",!1),$("#height").removeClass("isDisabled"),$("#rate").prop("disabled",!1),$("#rate").removeClass("isDisabled"),$("#video_codec").prop("disabled",!1),$("#video_codec").removeClass("isDisabled"),$("#video_codec option[value='']").remove(),$("#audio_codec").prop("disabled",!1),$("#audio_codec").removeClass("isDisabled"),$("#audio_codec option[value='']").remove()},showJsPresets:function(){$.each(all_presets_json,function(e,t){$("#globalPresetDropdown").append('<option value="'+e+'">'+t.name+"</option>")})}},n={init:function(){if($("#presetPage").length){n.showPresetJsOptions(),n.setCurrentPresetCategory();var e=$("#category").val();n.showOptionsForCategory(e),$("#category").change(function(){n.showOptionsForCategory(this.value)}),$("#target").change(function(){$("#globalPresetDropdown").empty(),n.updatePresetOptions(this.value)});var t=s.getUrlParameter("selected_preset");null!==t&&$.each(presets_data,function(e,o){var r=!1;if($.each(o,function(e,o){if(t===e)return $("#target").val(o.target).trigger("change"),$("#globalPresetDropdown").val(e),r=!0,!1}),!0===r)return!1})}},showPresetJsOptions:function(){$(".presetNonJsOptions").remove(),$(".presetJsOptions").show()},setCurrentPresetCategory:function(){$.each(presets_data[$("#target").val()],function(e,t){return $("#category").val(t.category).trigger("change"),!1})},updatePresetOptions:function(e){var t=!1;$.each(presets_data[e],function(e,o){$("#globalPresetDropdown").append($("<option></option>").attr("value",e).text(o.name)),t||($("#category").val(o.category).trigger("change"),t=!0)})},showOptionsForCategory:function(e){"audio"===e?($(".video_options").hide(),$(".video_options_input").prop("disabled",!0),$(".video_options_input").addClass("isDisabled"),$(".audio_options").show(),$(".audio_options_input").prop("disabled",!1),$(".audio_options_input").removeClass("isDisabled")):"video"===e?($(".video_options").show(),$(".video_options_input").prop("disabled",!1),$(".video_options_input").removeClass("isDisabled"),$(".audio_options").hide(),$(".audio_options_input").prop("disabled",!0),$(".audio_options_input").addClass("isDisabled")):($(".target_options").hide(),$(".audio_options_input").prop("disabled",!0),$(".audio_options_input").addClass("isDisabled"),$(".video_options_input").prop("disabled",!0),$(".video_options_input").addClass("isDisabled"))}},a={checkIfAudioVbrPage:function(){$("#audio_vbr").length&&a.handleAudioVbrPage()},setCategory:function(){try{"string"==typeof $("#category").val()?t.category=$("#category").val():(e("qgHandle setCategory - noCategory"),t.category="NO_CATEGORY")}catch(o){e("qgHandle checkCategory - noCategory"),t.category="NO_CATEGORY"}},handleAudioVbrPage:function(){$("#audio_vbr").change(function(){"0"!==this.value?l.hideCbrOptions():l.showCbrOptions()})},beforeUnload:function(){$(window).bind("beforeunload",function(){if(window.unsaved)return e("qgHandle qgJob Upload browser closed by user"),"You have unsaved changes on this page. Do you want to leave this page and discard your changes or stay on this page?"})}},s={getUrlParameter:function(e){var t={};return window.location.href.replace(location.hash,"").replace(/[?&]+([^=&]+)=?([^&]*)?/gi,function(e,o,r){t[o]=r!==undefined?r:""}),e?t[e]?t[e]:null:t}},l={showCbrOptions:function(){$("#bitrate").show()},hideCbrOptions:function(){$("#bitrate").val(0),$("#bitrate").hide()}};return{init:o}}(),qgHandleCloud=function(){return{init:function(e,t,o,r){switch(e){case"qgGdrive":qgGdrive.init(t,o,r)}}}}(),qgGdrive=function(){var e=function(e,o){try{if(void 0===o)o={};else if("string"==typeof o)o={info:o};else if("object"!=typeof o)try{o={info:JSON.stringify(o)}}catch(r){}try{t.jobId.length>0&&(o.job_id=JSON.stringify(t.jobId))}catch(r){}window.qgLogger.log(e,o)}catch(r){}},t={usesGdrive:!1,requestDomainJob:"",requestDomainOptions:"",inputForm:"#gdriveform",jobId:[],driveData:null,driveScope:"https://www.googleapis.com/auth/drive.readonly https://www.googleapis.com/auth/drive.install",driveClient:"",driveKey:"",driveDiscovery:["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"],driveFile:{},fallBack:!1},o={},r=[{info:{name:"Document converter",title:"Free online document converter",category:"document"},target:{"convert-to-doc":{method:"convert-to-doc",converter_name:"Convert to DOC",title:"Convert PDF and other documents to Word",raw_method:"doc",subdomain:"document",url:"/convert-to-doc",category:"document"},"convert-to-pdf":{method:"convert-to-pdf",converter_name:"Convert to PDF",title:"Convert documents and images to PDF",raw_method:"pdf",subdomain:"document",url:"/convert-to-pdf",category:"document"},"convert-to-docx":{method:"convert-to-docx",converter_name:"Convert to DOCX",title:"Convert your documents to DOCX",raw_method:"docx",subdomain:"document",url:"/convert-to-docx",category:"document"},"convert-to-txt":{method:"convert-to-txt",converter_name:"Convert to TXT",title:"Convert your document to text",raw_method:"txt",subdomain:"document",url:"/convert-to-txt",category:"document"},"convert-to-flash":{method:"convert-to-flash",converter_name:"Convert to Flash",title:"Convert files to a Flash slideshow",raw_method:"swf",subdomain:"document",url:"/convert-to-flash",category:"document"},"convert-to-html":{method:"convert-to-html",converter_name:"Convert to HTML",title:"Convert a document to HTML",raw_method:"html",subdomain:"document",url:"/convert-to-html",category:"document"},"convert-to-odt":{method:"convert-to-odt",converter_name:"Convert to ODT",title:"Convert to Open-Office ODT format",raw_method:"odt",subdomain:"document",url:"/convert-to-odt",category:"document"},"convert-to-ppt":{method:"convert-to-ppt",converter_name:"Convert to PPT",title:"Powerpoint converter",raw_method:"ppt",subdomain:"document",url:"/convert-to-ppt",category:"document"},"convert-to-pptx":{method:"convert-to-pptx",converter_name:"Convert to PPTX",title:"Convert files to the Powerpoint PPTX format",raw_method:"pptx",subdomain:"document",url:"/convert-to-pptx",category:"document"},"convert-to-rtf":{method:"convert-to-rtf",converter_name:"Convert to RTF",title:"Online RTF converter",raw_method:"rtf",subdomain:"document",url:"/convert-to-rtf",category:"document"}}},{info:{name:"Audio converter",title:"Convert your audio to another format",category:"audio"},target:{"convert-to-mp3":{method:"convert-to-mp3",converter_name:"Convert to MP3",title:"Convert audio to MP3",raw_method:"mp3",subdomain:"audio",url:"/convert-to-mp3",category:"audio"},"convert-to-ogg":{method:"convert-to-ogg",converter_name:"Convert to OGG",title:"Convert audio to the OGG format",raw_method:"ogg",subdomain:"audio",url:"/convert-to-ogg",category:"audio"},"convert-to-wav":{method:"convert-to-wav",converter_name:"Convert to WAV",title:"Convert audio to WAV",raw_method:"wav",subdomain:"audio",url:"/convert-to-wav",category:"audio"},"convert-to-wma":{method:"convert-to-wma",converter_name:"Convert to WMA",title:"Convert audio and video to WMA",raw_method:"wma",subdomain:"audio",url:"/convert-to-wma",category:"audio"},"convert-to-aac":{method:"convert-to-aac",converter_name:"Convert to AAC",title:"Music converter to AAC",raw_method:"aac",subdomain:"audio",url:"/convert-to-aac",category:"audio"},"convert-to-aiff":{method:"convert-to-aiff",converter_name:"Convert to AIFF",title:"Convert audio to AIFF",raw_method:"aiff",subdomain:"audio",url:"/convert-to-aiff",category:"audio"},"convert-to-flac":{method:"convert-to-flac",converter_name:"Convert to FLAC",title:"Convert audio to FLAC",raw_method:"flac",subdomain:"audio",url:"/convert-to-flac",category:"audio"},"convert-to-m4a":{method:"convert-to-m4a",converter_name:"Convert to M4A",title:"Online audio converter to M4A",raw_method:"m4a",subdomain:"audio",url:"/convert-to-m4a",category:"audio"},"convert-to-mmf":{method:"convert-to-mmf",converter_name:"Convert to MMF",title:"Convert audio to the MMF ringtone format",raw_method:"mmf",subdomain:"audio",url:"/convert-to-mmf",category:"audio"},"convert-to-opus":{method:"convert-to-opus",converter_name:"Convert to OPUS",title:"Convert files to the OPUS format",raw_method:"opus",subdomain:"audio",url:"/convert-to-opus",category:"audio"}}},{info:{name:"Audio converter",title:"Convert your audio to another format",category:"audio"},target:{"convert-to-mp3":{method:"convert-to-mp3",converter_name:"Convert to MP3",title:"Convert audio to MP3",raw_method:"mp3",subdomain:"audio",url:"/convert-to-mp3",category:"audio"},"convert-to-ogg":{method:"convert-to-ogg",converter_name:"Convert to OGG",title:"Convert audio to the OGG format",raw_method:"ogg",subdomain:"audio",url:"/convert-to-ogg",category:"audio"},"convert-to-wav":{method:"convert-to-wav",converter_name:"Convert to WAV",title:"Convert audio to WAV",raw_method:"wav",subdomain:"audio",url:"/convert-to-wav",category:"audio"},"convert-to-wma":{method:"convert-to-wma",converter_name:"Convert to WMA",title:"Convert audio and video to WMA",raw_method:"wma",subdomain:"audio",url:"/convert-to-wma",category:"audio"},"convert-to-aac":{method:"convert-to-aac",converter_name:"Convert to AAC",title:"Music converter to AAC",raw_method:"aac",subdomain:"audio",url:"/convert-to-aac",category:"audio"},"convert-to-aiff":{method:"convert-to-aiff",converter_name:"Convert to AIFF",title:"Convert audio to AIFF",raw_method:"aiff",subdomain:"audio",url:"/convert-to-aiff",category:"audio"},"convert-to-flac":{method:"convert-to-flac",converter_name:"Convert to FLAC",title:"Convert audio to FLAC",raw_method:"flac",subdomain:"audio",url:"/convert-to-flac",category:"audio"},"convert-to-m4a":{method:"convert-to-m4a",converter_name:"Convert to M4A",title:"Online audio converter to M4A",raw_method:"m4a",subdomain:"audio",url:"/convert-to-m4a",category:"audio"},"convert-to-mmf":{method:"convert-to-mmf",converter_name:"Convert to MMF",title:"Convert audio to the MMF ringtone format",raw_method:"mmf",subdomain:"audio",url:"/convert-to-mmf",category:"audio"},"convert-to-opus":{method:"convert-to-opus",converter_name:"Convert to OPUS",title:"Convert files to the OPUS format",raw_method:"opus",subdomain:"audio",url:"/convert-to-opus",category:"audio"}}},{info:{name:"Archive converter",title:"Convert archives",category:"archive"},target:{"convert-to-zip":{method:"convert-to-zip",converter_name:"Convert to ZIP",title:"Convert your files to the ZIP format",raw_method:"zip",subdomain:"archive",url:"/convert-to-zip",category:"archive"},"convert-to-7z":{method:"convert-to-7z",converter_name:"Convert to 7Z",title:"7z file converter",raw_method:"7z",subdomain:"archive",url:"/convert-to-7z",category:"archive"},"convert-to-bz2":{method:"convert-to-bz2",converter_name:"Convert to TAR.BZ2",title:"Create TAR.BZ2 archives online",raw_method:"bz2",subdomain:"archive",url:"/convert-to-bz2",category:"archive"},"convert-to-gz":{method:"convert-to-gz",converter_name:"Convert to TAR.GZ",title:"Online TAR.GZ compressor",raw_method:"gz",subdomain:"archive",url:"/convert-to-gz",category:"archive"}}},{info:{name:"Image converter",title:"Online image converter",category:"image"},target:{"convert-to-jpg":{method:"convert-to-jpg",converter_name:"Convert to JPG",title:"Online image converter to JPEG",raw_method:"jpg",subdomain:"image",url:"/convert-to-jpg",category:"image"},"convert-to-png":{method:"convert-to-png",converter_name:"Convert to PNG",title:"Convert image to PNG",raw_method:"png",subdomain:"image",url:"/convert-to-png",category:"image"},"convert-to-gif":{method:"convert-to-gif",converter_name:"Convert to GIF",title:"Convert files to GIF",raw_method:"gif",subdomain:"image",url:"/convert-to-gif",category:"image"},"convert-to-bmp":{method:"convert-to-bmp",converter_name:"Convert to BMP",title:"Convert an image to the BMP format",raw_method:"bmp",subdomain:"image",url:"/convert-to-bmp",category:"image"},"convert-to-eps":{method:"convert-to-eps",converter_name:"Convert to EPS",title:"Convert an image to the EPS format",raw_method:"eps",subdomain:"image",url:"/convert-to-eps",category:"image"},"convert-to-exr":{method:"convert-to-exr",converter_name:"Convert to HDR/EXR",title:"Convert an image to the High dynamic-range (HDR) .EXR format",raw_method:"exr",subdomain:"image",url:"/convert-to-exr",category:"image"},"convert-to-ico":{method:"convert-to-ico",converter_name:"Convert to ICO",title:"Convert your image to the ICO format",raw_method:"ico",subdomain:"image",url:"/convert-to-ico",category:"image"},"convert-to-svg":{method:"convert-to-svg",converter_name:"Convert to SVG",title:"Convert image to the SVG format",raw_method:"svg",subdomain:"image",url:"/convert-to-svg",category:"image"},"convert-to-tga":{method:"convert-to-tga",converter_name:"Convert to TGA",title:"Convert image to TGA format",raw_method:"tga",subdomain:"image",url:"/convert-to-tga",category:"image"},"convert-to-tiff":{method:"convert-to-tiff",converter_name:"Convert to TIFF",title:"Convert image to TIFF format",raw_method:"tiff",subdomain:"image",url:"/convert-to-tiff",category:"image"},"convert-to-wbmp":{method:"convert-to-wbmp",converter_name:"Convert to WBMP",title:"Convert image to WBMP (mobile format)",raw_method:"wbmp",subdomain:"image",url:"/convert-to-wbmp",category:"image"},"convert-to-webp":{method:"convert-to-webp",converter_name:"Convert to WebP",title:"Convert an image to WebP",raw_method:"webp",subdomain:"image",url:"/convert-to-webp",category:"image"}}},{info:{name:"Video converter",title:"Video file converter",category:"video"},target:{"convert-to-3gp":{method:"convert-to-3gp",converter_name:"Convert to 3GP",title:"Convert video to 3GP",raw_method:"3gp",subdomain:"video",url:"/convert-to-3gp",category:"video"},"convert-to-avi":{method:"convert-to-avi",converter_name:"Convert to AVI",title:"Online AVI video converter",raw_method:"avi",subdomain:"video",url:"/convert-to-avi",category:"video"},"convert-to-mkv":{method:"convert-to-mkv",converter_name:"Convert to MKV",title:"Convert video to the Matroska (MKV) format",raw_method:"mkv",subdomain:"video",url:"/convert-to-mkv",category:"video"},"convert-to-mp4":{method:"convert-to-mp4",converter_name:"Convert to MP4",title:"Convert video to MP4",raw_method:"mp4",subdomain:"video",url:"/convert-to-mp4",category:"video"},"convert-to-3g2":{method:"convert-to-3g2",converter_name:"Convert to 3G2",title:"3G2 video converter",raw_method:"3g2",subdomain:"video",url:"/convert-to-3g2",category:"video"},"convert-to-flv":{method:"convert-to-flv",converter_name:"Convert to FLV",title:"Online video converter to FLV",raw_method:"flv",subdomain:"video",url:"/convert-to-flv",category:"video"},"convert-to-mov":{method:"convert-to-mov",converter_name:"Convert to MOV",title:"Convert video to Quicktime MOV",raw_method:"mov",subdomain:"video",url:"/convert-to-mov",category:"video"},"convert-to-mpeg-1":{method:"convert-to-mpeg-1",converter_name:"Convert to MPEG-1",title:"Convert video to MPEG-1",raw_method:"mpeg1",subdomain:"video",url:"/convert-to-mpeg-1",category:"video"},"convert-to-mpeg-2":{method:"convert-to-mpeg-2",converter_name:"Convert to MPEG-2",title:"Convert video to MPEG-2",raw_method:"mpeg2",subdomain:"video",url:"/convert-to-mpeg-2",category:"video"},"convert-to-ogv":{method:"convert-to-ogv",converter_name:"Convert to OGV",title:"Convert video to the OGV format",raw_method:"ogg",subdomain:"video",url:"/convert-to-ogv",category:"video"},"convert-to-webm":{method:"convert-to-webm",converter_name:"Convert to WEBM",title:"Video converter to convert to the WebM format (VP8)",raw_method:"webm",subdomain:"video",url:"/convert-to-webm",category:"video"},"convert-to-wmv":{method:"convert-to-wmv",converter_name:"Convert to WMV",title:"Online WMV video converter",raw_method:"wmv",subdomain:"video",url:"/convert-to-wmv",category:"video"},"convert-video-for-android":{method:"convert-video-for-android",converter_name:"Convert video for Android",title:"Convert video for Android devices",raw_method:"android",subdomain:"video",url:"/convert-video-for-android",category:"video"},"convert-video-for-blackberry":{method:"convert-video-for-blackberry",converter_name:"Convert video for Blackberry",title:"Blackberry video converter",raw_method:"Blackberry",subdomain:"video",url:"/convert-video-for-blackberry",category:"video"},"convert-video-for-ipad":{method:"convert-video-for-ipad",converter_name:"Convert video for iPad",title:"iPad video converter",raw_method:"ipad",subdomain:"video",url:"/convert-video-for-ipad",category:"video"},"convert-video-for-iphone":{method:"convert-video-for-iphone",converter_name:"Convert video for iPhone",title:"Convert your video for your iPhone",raw_method:"iphone",subdomain:"video",url:"/convert-video-for-iphone",category:"video"},"convert-video-for-ipod":{method:"convert-video-for-ipod",converter_name:"Convert video for iPod",title:"Online video to iPod converter",raw_method:"ipod",subdomain:"video",url:"/convert-video-for-ipod",category:"video"},"convert-video-for-nintendo-3ds":{method:"convert-video-for-nintendo-3ds",converter_name:"Convert video for Nintendo 3DS",title:"Convert videos for the Nintendo 3DS",raw_method:"3ds",subdomain:"video",url:"/convert-video-for-nintendo-3ds",category:"video"},"convert-video-for-nintendo-ds":{method:"convert-video-for-nintendo-ds",converter_name:"Convert video for Nintendo DS",title:"Convert your video to the Nintendo DS DPG format",raw_method:"dpg",subdomain:"video",url:"/convert-video-for-nintendo-ds",category:"video"},"convert-video-for-ps3":{method:"convert-video-for-ps3",converter_name:"Convert video for PS3",title:"Convert video for Playstation3 (PS3)",raw_method:"ps3",subdomain:"video",url:"/convert-video-for-ps3",category:"video"},"convert-video-for-psp":{method:"convert-video-for-psp",converter_name:"Convert video for PSP",title:"Convert video for your PSP",raw_method:"psp",subdomain:"video",url:"/convert-video-for-psp",category:"video"},"convert-video-for-wii":{method:"convert-video-for-wii",converter_name:"Convert video for Wii",title:"Convert video for Nintendo Wii",raw_method:"wii",subdomain:"video",url:"/convert-video-for-wii",category:"video"},"convert-video-for-xbox":{method:"convert-video-for-xbox",converter_name:"Convert video for XBOX 360",title:"Convert video for the XBOX 360",raw_method:"xbox",subdomain:"video",url:"/convert-video-for-xbox",category:"video"}}},{info:{name:"Webservice converter",title:"Optimize a file for a webservice",category:"webservice"},target:{"convert-video-for-dailymotion":{method:"convert-video-for-dailymotion",converter_name:"Convert for Dailymotion",title:"Dailymotion video converter",raw_method:"mp4",subdomain:"webservice",url:"/convert-video-for-dailymotion",category:"video",name:"dailymotion"},"convert-for-facebook":{method:"convert-for-facebook",converter_name:"Convert for Facebook",title:"Convert your video for Facebook",raw_method:"mp4",subdomain:"webservice",url:"/convert-for-facebook",category:"video",name:"facebook"},"convert-for-instagram":{method:"convert-for-instagram",converter_name:"Convert for Instagram",title:"Convert video for Instagram",raw_method:"mp4",subdomain:"webservice",url:"/convert-for-instagram",category:"video",name:"instagram"},"convert-for-telegram":{method:"convert-for-telegram",converter_name:"Convert for Telegram",title:"Convert a file for Telegram",raw_method:"mp4",subdomain:"webservice",url:"/convert-for-telegram",category:"video",name:"telegram"},"convert-video-for-twitch":{method:"convert-video-for-twitch",converter_name:"Convert for Twitch",title:"Convert your file for Twitch",raw_method:"mp4",subdomain:"webservice",url:"/convert-video-for-twitch",category:"video",name:"twitch"},"convert-for-twitter":{method:"convert-for-twitter",converter_name:"Convert for Twitter",title:"Convert your file for Twitter",raw_method:"mp4",subdomain:"webservice",url:"/convert-for-twitter",category:"video",name:"twitter"},"convert-video-for-viber":{method:"convert-video-for-viber",converter_name:"Convert for Viber",title:"Viber video converter",raw_method:"mp4",subdomain:"webservice",url:"/convert-video-for-viber",category:"video",name:"viber"},"convert-video-for-vimeo":{method:"convert-video-for-vimeo",converter_name:"Convert for Vimeo",title:"Video converter for vimeo",raw_method:"mp4",subdomain:"webservice",url:"/convert-video-for-vimeo",category:"video",name:"vimeo"},"convert-for-whatsapp":{method:"convert-for-whatsapp",converter_name:"Convert for WhatsApp",title:"Convert a file for WhatsApp",raw_method:"mp4",subdomain:"webservice",url:"/convert-for-whatsapp",category:"video",name:"whatsapp"},"convert-video-for-youtube":{method:"convert-video-for-youtube",converter_name:"Convert for Youtube",title:"Video converter for Youtube",raw_method:"mp4",subdomain:"webservice",url:"/convert-video-for-youtube",category:"video",name:"youtube"}}}],i=function(e,o,r){t.usesGdrive=!0,t.driveClient=o,t.driveKey=r,""!==e&&(d.showProgress(),a.parseDriveData(e),n.loadAuth())},n={initClient:function(){window.gapi&&(window.gapi.client.init({discoveryDocs:t.driveDiscovery,clientId:t.driveClient,scope:t.driveScope}),qgGdrive.drive.onAuthApiLoad())},loadAuth:function(){window.gapi&&gapiPromise.then(function(){window.gapi.load("client:auth",qgGdrive.drive.initClient)})},onAuthApiLoad:function(){window.gapi&&window.gapi.auth.authorize({client_id:t.driveClient,scope:t.driveScope,prompt:"none",login_hint:t.driveData.userId},qgGdrive.drive.handleAuthResult)},onAuthApiLoadScope:function(){window.gapi&&window.gapi.auth.authorize({client_id:t.driveClient,scope:t.driveScope,prompt:"consent",login_hint:t.driveData.userId},qgGdrive.drive.handleAuthResult)},handleAuthResult:function(e){e&&!e.error?(t.driveFile.token=e.access_token,"object"==typeof t.driveData.ids?n.getFileMetadata(t.driveData.ids[0]):n.getFileMetadata(t.driveData.exportIds[0])):s.renderConsent()},onDriveCallback:function(){},getFileMetadata:function(e){if(window.gapi){d.showProgress();gapi.client.drive.files.get({fileId:e}).execute(function(o){404===o.code?!1===t.fallBack&&(t.fallBack=!0,n.onAuthApiLoadScope()):n.setFile(o.name,e,o.mimeType,t.driveFile.token)})}},setFile:function(e,o,r,i){t.driveFile.token=i,t.driveFile.fileName=e,t.driveFile.fileId=o,t.driveFile.mimeType=r,a.processDriveFile()},checkUsesGdrive:function(){return t.usesGdrive}},a={parseDriveData:function(e){try{t.driveData=JSON.parse(e)}catch(o){}},processDriveFile:function(){var o="",r=t.driveFile.mimeType;o=t.driveFile.fileName.indexOf(".")>-1?t.driveFile.fileName.substr(t.driveFile.fileName.lastIndexOf(".")+1):r,t.driveFile.url="?g_fileid="+t.driveFile.fileId+"&g_filename="+t.driveFile.fileName+"&g_token="+t.driveFile.token+"&g_mimetype="+t.driveFile.mimeType+"&g_sizebytes="+t.driveFile.sizeBytes,e("qgGdrive processDrive options extension",{extension:o}),qgFileoptions.getOptions(qgGdrive.qgEndpoint.requestDomainOptions,o,r).done(function(e){s.renderOptions(e)}).fail(function(e,t){if(400!==t.status)return alert(qgValidate.qgMessages.networkErrorMessage),void d.resetPage();s.renderGenericOptions()})}},s={renderConsent:function(){d.hideProgress(),$("#gdriveConsent").click(function(){n.onAuthApiLoadScope()}),$("#gdriveConsent-box").show(),$("#drive_picker").hide()},renderOptions:function(e){$("#gdrive_input").val(JSON.stringify(t.driveFile)),$("#g-filename").html(t.driveFile.fileName),$("#g-selected-file").show(),$("#gdrive-options").empty(),d.hideProgress(),$.each(e,function(e,o){if(0!==o.target.length){var r="<h2>"+o.info.name+'</h2><div id="gcat-'+e+'"></div>';$("#gdrive-options").append(r),$.each(o.target,function(o,r){var i=$("#convert-tpl").clone();i.find(".submit_button_big").val(r.converter_name),i.find(".submit_button_big").attr("name",o),i.find(".submit_button_big").attr("data-category",r.category),i.find(".submit_button_big").attr("data-target",r.raw_method),i.find("a").attr("href",r.url+t.driveFile.url),i.appendTo("#gcat-"+e),i.show()})}}),$(".submit_button_big").click(function(){$("#target").val($(this).attr("data-target")),$("#category").val($(this).attr("data-category")),s.createJob()})},renderGenericOptions:function(){var e=window.location.host.split("."),t=window.location.protocol+"//",o=e[1]+"."+e[2];$.each(r,function(e,r){$.each(r.target,function(e,r){r.url=t+r.subdomain+"."+o+r.url})}),s.renderOptions(r)},createJob:function(){d.showUpload(),qgJob.createJob(qgGdrive.qgEndpoint.requestDomainJob,t.inputForm).done(function(o,r){if("string"==typeof o.job_id)t.jobId.push(o.job_id),e("qgGdrive qgJob createJob success"),!0===o.redirect&&(e("qgGdrive qgUpload UploadSingleFile success with remote input"),s.showResult(o.job_id));else try{1==o.error.code?(e("qgGdrive qgJob createJob fail - overuse"),window.location=qgGdrive.qgEndpoint.overuseUrl):3==o.error.code?(e("qgGdrive qgJob createJob fail - "+o.error.text),alert(o.error.text),d.resetPage()):l(o,r)}catch(i){l(o,r)}}).fail(function(t,o){try{1==t.error.code?(e("qgGdrive qgJob createJob fail - overuse"),window.location=qgGdrive.qgEndpoint.overuseUrl):3==t.error.code?(e("qgGdrive qgJob createJob fail - "+t.error.text),alert(t.error.text),d.resetPage()):l(t,o)}catch(r){l(t,o)}})},showResult:function(e){window.location=qgGdrive.qgEndpoint.requestDomainResult+e}},l=function(o,r){try{var i=JSON.stringify(o),n=JSON.stringify(r)}catch(a){var i=JSON.stringify(a),n="empty"}t.maxRetriesJob>0?(e("qgGdrive qgJob createJob fail - retry",{server_response:i,form_info_data:n}),t.maxRetriesJob-=1,window.setTimeout(s.createJob,t.retryTimeoutJob)):(e("qgGdrive qgJob createJob critical fail - retries exhausted",{server_response:i,form_info_data:n}),alert(qgValidate.qgMessages.networkErrorMessage),d.resetPage())},d={showProgress:function(){$("#gdriveConsent-box").hide(),$("#drive_picker").hide(),$("#oc-ajax-loader-bar").show()},hideProgress:function(){$("#gdriveConsent-box").hide(),$("#drive_picker").show(),$("#oc-ajax-loader-bar").hide()},showUpload:function(){$("#drive_picker").css("pointer-events","none"),$("#drive_picker").css("pointer-events","none"),$("#gdrive-options").hide(),$("#oc-ajax-loader-bar-uploading").show()},hideUpload:function(){$("#drive_picker").css("pointer-events","all"),$("#drive_picker").css("pointer-events","all"),$("#gdrive-options").show(),$("#oc-ajax-loader-bar-uploading").hide()},resetPage:function(){d.hideProgress(),d.hideUpload()}};return{init:i,qgEndpoint:o,drive:n}}();